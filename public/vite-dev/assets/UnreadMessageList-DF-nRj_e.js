import{e as g,m as E}from"./globalConfig-DaGjiImb.js";import{c as b,u as N,i as S,O as I,a as C}from"./widget-CI6WQx7h.js";import{F as k}from"./Index-CtF_0wrY.js";import{u as U}from"./useMessageFormatter-CoQTTzFX.js";import{T as A}from"./Thumbnail-DLjRBBx8.js";import{_ as v,o,n as c,p as n,e as h,g as u,k as M,q as y,u as _,H as x,m as p,t as f,F as V,i as T,B,a as F}from"./_plugin-vue_export-helper-CvYNw_mv.js";import{i as O}from"./colorHelper-DkkSNPxc.js";const D={name:"UnreadMessage",components:{Thumbnail:A},mixins:[b],props:{message:{type:String,default:""},showSender:{type:Boolean,default:!1},sender:{type:Object,default:()=>{}},campaignId:{type:Number,default:null}},setup(){const{formatMessage:e,getPlainText:s,truncateMessage:r,highlightContent:i}=U(),{getThemeClass:d}=N();return{formatMessage:e,getPlainText:s,truncateMessage:r,highlightContent:i,getThemeClass:d}},computed:{companyName(){return`${this.$t("UNREAD_VIEW.COMPANY_FROM")} ${this.channelConfig.websiteName}`},avatarUrl(){const e=this.useInboxAvatarForBot?this.inboxAvatarUrl:"/assets/images/chatwoot_bot.png";if(this.isSenderExist(this.sender)){const{avatar_url:s}=this.sender;return s}return e},agentName(){if(this.isSenderExist(this.sender)){const{available_name:e}=this.sender;return e}return this.useInboxAvatarForBot?this.channelConfig.websiteName:this.$t("UNREAD_VIEW.BOT")},availabilityStatus(){if(this.isSenderExist(this.sender)){const{availability_status:e}=this.sender;return e}return null}},methods:{isSenderExist(e){return e&&!S(e)},onClickMessage(){this.campaignId?g.emit(I,this.campaignId):g.emit(C)}}},L={class:"chat-bubble-wrap"},W={key:0,class:"row--agent-block"},G={class:"agent--name"},R={class:"company--name"},z={class:"message-content"};function $(e,s,r,i,d,t){const m=_("Thumbnail"),l=x("dompurify-html");return o(),c("div",L,[n("button",{class:y(["chat-bubble agent",i.getThemeClass("bg-white","dark:bg-slate-50")]),onClick:s[0]||(s[0]=(...a)=>t.onClickMessage&&t.onClickMessage(...a))},[r.showSender?(o(),c("div",W,[h(m,{src:t.avatarUrl,size:"20px",username:t.agentName,status:t.availabilityStatus},null,8,["src","username","status"]),u(n("span",G,null,512),[[l,t.agentName]]),u(n("span",R,null,512),[[l,t.companyName]])])):M("",!0),u(n("div",z,null,512),[[l,i.formatMessage(r.message,!1)]])],2)])}const P=v(D,[["render",$],["__scopeId","data-v-30ef2701"]]),j={name:"Unread",components:{FluentIcon:k,UnreadMessage:P},mixins:[b],props:{messages:{type:Array,required:!0}},emits:["close"],computed:{...E({unreadMessageCount:"conversation/getUnreadMessageCount",widgetColor:"appConfig/getWidgetColor"}),sender(){const[e]=this.messages;return e.sender||{}},isBackgroundLighter(){return O(this.widgetColor)}},methods:{openConversationView(){g.emit(C)},closeFullView(){this.$emit("close")},getMessageContent(e){const{attachments:s,content:r}=e,i=s&&s.length;return r||(i?"ðŸ“‘":"")}}},q={class:"unread-wrap"},K={class:"close-unread-wrap"},H={class:"flex items-center"},Y={class:"unread-messages"},J={class:"open-read-view-wrap"};function Q(e,s,r,i,d,t){const m=_("FluentIcon"),l=_("UnreadMessage");return o(),c("div",q,[n("div",K,[n("button",{class:"button small close-unread-button",onClick:s[0]||(s[0]=(...a)=>t.closeFullView&&t.closeFullView(...a))},[n("span",H,[h(m,{class:"mr-1",icon:"dismiss",size:"12"}),p(" "+f(e.$t("UNREAD_VIEW.CLOSE_MESSAGES_BUTTON")),1)])])]),n("div",Y,[(o(!0),c(V,null,T(r.messages,(a,w)=>(o(),F(l,{key:a.id,"message-type":a.messageType,"message-id":a.id,"show-sender":!w,sender:a.sender,message:t.getMessageContent(a),"campaign-id":a.campaignId},null,8,["message-type","message-id","show-sender","sender","message","campaign-id"]))),128))]),n("div",J,[e.unreadMessageCount?(o(),c("button",{key:0,class:"button clear-button",onClick:s[1]||(s[1]=(...a)=>t.openConversationView&&t.openConversationView(...a))},[n("span",{class:y(["flex items-center",{"is-background-light":t.isBackgroundLighter}]),style:B({color:e.widgetColor})},[h(m,{class:"mr-2",size:"16",icon:"arrow-right"}),p(" "+f(e.$t("UNREAD_VIEW.VIEW_MESSAGES_BUTTON")),1)],6)])):M("",!0)])])}const re=v(j,[["render",Q],["__scopeId","data-v-86faf6b0"]]);export{re as U};
