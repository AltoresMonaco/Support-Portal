import{aq as B,c as g,r as y,w as D,P as H,u as x,H as z,g as F,o as h,n as _,q as L,b as C,F as I,i as R,a as T,e as $,k as S,z as M,p as k,t as A,l as N,m as P}from"./_plugin-vue_export-helper-CvYNw_mv.js";import{v as W,f as j}from"./mutationHelpers-3VTcoJiD.js";import{w as Y}from"./DashboardIcon-CPXNa31t.js";import{f as G}from"./vue-router-CNCrM2WK.js";const U=["title"],ue={__name:"CardLabels",props:{conversationLabels:{type:Array,required:!0}},setup(t){const e=t,s=B(),r=W("labels/getLabels"),a=g(()=>r.value.filter(({title:i})=>e.conversationLabels.includes(i))),o=y(!1),c=y(!1),d=y(-1),u=y(null),l=()=>{const i=s.before?100:0;if(!u.value)return;const p=Array.from(u.value.querySelectorAll(".label"));let n=0;c.value=!1,p.forEach((f,m)=>{n+=f.offsetWidth+8,n<u.value.clientWidth-i?d.value=m:c.value=p.length>1})};D(a,()=>{M(()=>l())}),H(()=>{l()});const v=i=>{i.stopPropagation(),o.value=!o.value,M(()=>l())};return(i,p)=>{const n=x("woot-label"),f=x("fluent-icon"),m=z("resize");return F((h(),_("div",{ref_key:"labelContainer",ref:u},[a.value.length||i.$slots.before?(h(),_("div",{key:0,class:L(["flex items-end flex-shrink min-w-0 gap-y-1",{"h-auto overflow-visible flex-row flex-wrap":o.value}])},[C(i.$slots,"before"),(h(!0),_(I,null,R(a.value,(b,w)=>(h(),T(n,{key:b?b.id:w,title:b.title,description:b.description,color:b.color,variant:"smooth",class:L(["!mb-0 max-w-[calc(100%-0.5rem)]",{"invisible absolute":!o.value&&w>d.value}]),small:""},null,8,["title","description","color","class"]))),128)),c.value?(h(),_("button",{key:0,title:o.value?i.$t("CONVERSATION.CARD.HIDE_LABELS"):i.$t("CONVERSATION.CARD.SHOW_LABELS"),class:"h-5 py-0 px-1 flex-shrink-0 mr-6 ml-0 rtl:ml-6 rtl:mr-0 rtl:rotate-180 text-slate-700 dark:text-slate-200 hover:border-slate-300 border-slate-100 dark:border-slate-700",onClick:v},[$(f,{icon:o.value?"chevron-left":"chevron-right",size:"12"},null,8,["icon"])],8,U)):S("",!0)],2)):S("",!0)])),[[m,l]])}}},J={class:"flex justify-between w-full"},K={class:"text-sm sticky top-0 h-fit font-normal tracking-[-0.6%] min-w-[140px] truncate text-slate-600 dark:text-slate-200"},Q={class:"flex flex-col w-full gap-2"},E={__name:"SLAEventItem",props:{label:{type:String,required:!0},items:{type:Array,required:!0}},setup(t){const e=s=>j(G(s),"MMM dd, yyyy, hh:mm a");return(s,r)=>(h(),_("div",J,[k("span",K,A(t.label),1),k("div",Q,[(h(!0),_(I,null,R(t.items,a=>(h(),_("span",{key:a.id,class:"text-sm font-normal text-slate-900 dark:text-slate-25 text-right tabular-nums"},A(e(a.created_at)),1))),128)),C(s.$slots,"showMore")])]))}},X={class:"absolute flex flex-col items-start bg-white dark:bg-slate-800 z-50 p-4 border border-solid border-slate-75 dark:border-slate-700 w-[384px] rounded-xl gap-4 max-h-96 overflow-auto"},Z={class:"text-sm font-medium text-slate-900 dark:text-slate-25"},ee={key:0,class:"flex flex-col items-end w-full"},ce={__name:"SLAPopoverCard",props:{slaMissedEvents:{type:Array,required:!0}},setup(t){const e=t,{SLA_MISS_TYPES:s}=Y,r=y(!1),a=g(()=>e.slaMissedEvents.filter(l=>l.event_type===s.FRT)),o=g(()=>{const l=e.slaMissedEvents.filter(v=>v.event_type===s.NRT);return r.value?l:l.slice(0,6)}),c=g(()=>e.slaMissedEvents.filter(l=>l.event_type===s.RT)),d=g(()=>o.value.length>6),u=()=>{r.value=!r.value};return(l,v)=>{const i=x("woot-button");return h(),_("div",X,[k("span",Z,A(l.$t("SLA.EVENTS.TITLE")),1),a.value.length?(h(),T(E,{key:0,label:l.$t("SLA.EVENTS.FRT"),items:a.value},null,8,["label","items"])):S("",!0),o.value.length?(h(),T(E,{key:1,label:l.$t("SLA.EVENTS.NRT"),items:o.value},{showMore:N(()=>[d.value?(h(),_("div",ee,[$(i,{size:"small",icon:r.value?"":"plus-sign",variant:"link","color-scheme":"secondary",class:"hover:!no-underline !gap-1 hover:!bg-transparent dark:hover:!bg-transparent",onClick:u},{default:N(()=>[P(A(r.value?l.$t("SLA.EVENTS.HIDE",{count:o.value.length}):l.$t("SLA.EVENTS.SHOW_MORE",{count:o.value.length})),1)]),_:1},8,["icon"])])):S("",!0)]),_:1},8,["label","items"])):S("",!0),c.value.length?(h(),T(E,{key:2,label:l.$t("SLA.EVENTS.RT"),items:c.value},null,8,["label","items"])):S("",!0)])}}};function te(t,e){t.length<e.length&&([t,e]=[e,t]);let s=t.length,r=e.length;if(s===0||r===0)return 0;let a=Math.floor(s/2)-1,o=Array(r).fill(!1),c=Array(s).fill(""),d=0;for(let n=0;n<s;n++){let f=t[n];for(let m=0;m<r;m++){let b=e[m];if(m<=n+a&&m+a>=1&&f===b&&!o[m]){o[m]=!0,c[d++]=f;break}}}if(!d)return 0;let u=0;for(let n=0,f=0;f<r;f++)o[f]&&(e[f]!==c[n]&&u++,n++);let l=d,v=(l/s+l/r+(l-u/2)/l)/3,i=0,p=Math.min(4,r);for(let n=0;n<p;n++)t[n]===e[n]&&i++;return v+i*.1*(1-v)}function V(t,e){let s=0,r=0;if(e&&t.length!==e.length)throw new Error("The number of values must be equal to the number of weights");for(let a=0;a<t.length;a++){let o=e?e[a]:1;s+=t[a]*o,r+=o}return s/r}function le(t){return Math.max(0,Math.min(1,t))}function O(t){return t.split(/\s+/).filter((e,s,r)=>e&&r.indexOf(e)===s)}var q={CONTAINS_MATCH:1.2,FIRST_SIMILARITY:1.1,STARTS_WITH:1.05};function fe(t,e,s,r){if(!e||typeof e!="string")return t;let a=[],o=(r==null?void 0:r.threshold)??.8,c=e.trim().toLowerCase(),d=O(c);return t.forEach(u=>{let l=[],v=[];s.forEach(p=>{var b;let n,f=1;typeof p=="string"?n=p:(n=p.name,f=p.weight),v.push(f);let m=(b=u[n])==null?void 0:b.trim().toLowerCase();if(m){let w=se(m,d);l.push(w)}else l.push(0)});let i=V(l,v);i>=o&&a.push({object:u,similarity:i})}),a.sort((u,l)=>l.similarity-u.similarity),a.map(u=>u.object)}function se(t,e){let s=O(t),r=e.map(a=>{let o=s.map(d=>re(d,a)),c=Math.max(...o);return c===o[0]?c*q.FIRST_SIMILARITY:le(c)});return V(r)}function re(t,e){let s=te(t,e);return t.includes(e)?s*q.CONTAINS_MATCH:s}export{ce as _,ue as a,fe as j};
