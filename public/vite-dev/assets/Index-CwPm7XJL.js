import{u as n,a as l}from"./index-BaHWIRRA.js";import{f as R}from"./vue-router-CNCrM2WK.js";import{f as u}from"./mutationHelpers-3VTcoJiD.js";import{R as E}from"./FilterSelector-B06zYLqE.js";import{G as h}from"./constants-CvJgIWgr.js";import{av as f}from"./dashboard-CGLIihvy.js";import{R as S}from"./ReportContainer-Dd_ptqR_.js";import{_ as T,o as O,n as d,e as s,l as I,u as i,m as N,t as g}from"./_plugin-vue_export-helper-CvYNw_mv.js";import"./globalConfig-DaGjiImb.js";import"./index-Y4OjWrJ-.js";import"./_commonjsHelpers-BosuxZz1.js";import"./index-BP-sUqpX.js";import"./index-DaWXXnfb.js";import"./DateRangePicker-BS8Sn4en.js";import"./index.es-CaHyKWHu.js";import"./DateHelper-D7GM2F2-.js";import"./index-CbMJaKeB.js";import"./axios-CCb-kr4I.js";import"./globalConfigMixin-BNbqaRx5.js";import"./timeHelper-BT38nsET.js";import"./Spinner-B-aSVz3z.js";import"./Thumbnail-DLjRBBx8.js";import"./index-BO4rcqbh.js";import"./utils.esm-CA3tRshB.js";import"./exports-CsC-x4VI.js";import"./index-C2DForDf.js";import"./useKeyboardNavigableList-Cfstgo2Q.js";import"./helper-DcGaBm2u.js";import"./DashboardIcon-CPXNa31t.js";import"./AudioNotificationHelper-CDrFIep2.js";import"./Icon-Dtj3LCzD.js";import"./Validators-eX6_8wdj.js";import"./vue-dompurify-html-DZ5r8uTJ.js";import"./module-CGzIBJZi.js";import"./BarChart-Cyq4Hy7M.js";const A={CONVERSATIONS:"conversations_count",INCOMING_MESSAGES:"incoming_messages_count",OUTGOING_MESSAGES:"outgoing_messages_count",FIRST_RESPONSE_TIME:"avg_first_response_time",RESOLUTION_TIME:"avg_resolution_time",RESOLUTION_COUNT:"resolutions_count",REPLY_TIME:"reply_time"},C={name:"ConversationReports",components:{ReportFilterSelector:E,ReportContainer:S},data(){return{from:0,to:0,groupBy:h[1],businessHours:!1}},methods:{fetchAllData(){this.fetchAccountSummary(),this.fetchChartData()},fetchAccountSummary(){try{this.$store.dispatch("fetchAccountSummary",this.getRequestPayload())}catch{n(this.$t("REPORT.SUMMARY_FETCHING_FAILED"))}},fetchChartData(){["CONVERSATIONS","INCOMING_MESSAGES","OUTGOING_MESSAGES","FIRST_RESPONSE_TIME","RESOLUTION_TIME","RESOLUTION_COUNT","REPLY_TIME"].forEach(async t=>{try{await this.$store.dispatch("fetchAccountReport",{metric:A[t],...this.getRequestPayload()})}catch{n(this.$t("REPORT.DATA_FETCHING_FAILED"))}})},getRequestPayload(){const{from:t,to:e,groupBy:o,businessHours:r}=this;return{from:t,to:e,groupBy:o==null?void 0:o.period,businessHours:r}},downloadAgentReports(){const{from:t,to:e}=this,o=`agent-report-${u(R(e),"dd-MM-yyyy")}.csv`;this.$store.dispatch("downloadAgentReports",{from:t,to:e,fileName:o})},onFilterChange({from:t,to:e,groupBy:o,businessHours:r}){this.from=t,this.to=e,this.groupBy=o,this.businessHours=r,this.fetchAllData(),l(f.FILTER_REPORT,{filterValue:{from:t,to:e,groupBy:o,businessHours:r},reportType:"conversations"})}}},y={class:"flex-1 p-4 overflow-auto"};function M(t,e,o,r,m,a){const p=i("woot-button"),c=i("ReportFilterSelector"),_=i("ReportContainer");return O(),d("div",y,[s(p,{"color-scheme":"success","class-names":"button--fixed-top",icon:"arrow-download",onClick:a.downloadAgentReports},{default:I(()=>[N(g(t.$t("REPORT.DOWNLOAD_AGENT_REPORTS")),1)]),_:1},8,["onClick"]),s(c,{"show-agents-filter":!1,"show-group-by-filter":"",onFilterChange:a.onFilterChange},null,8,["onFilterChange"]),s(_,{"group-by":m.groupBy},null,8,["group-by"])])}const ct=T(C,[["render",M]]);export{ct as default};
