import{u as f,r as N,c as I,d as b}from"./index-C2DForDf.js";import{m as O}from"./globalConfig-DaGjiImb.js";import{u as R}from"./index-BaHWIRRA.js";import{u as v,V as G,x as C,F as U,aj as S,ak as D}from"./dashboard-CGLIihvy.js";import{_ as F,o as i,n as u,f as M,p as o,t as a,q as A,m as c,g as m,U as p,k as d,a0 as w,F as y,i as V,e as g,a as k,u as T}from"./_plugin-vue_export-helper-CvYNw_mv.js";import"./index-Y4OjWrJ-.js";import"./_commonjsHelpers-BosuxZz1.js";import"./axios-CCb-kr4I.js";import"./mutationHelpers-3VTcoJiD.js";import"./vue-router-CNCrM2WK.js";import"./index-BP-sUqpX.js";import"./index-DaWXXnfb.js";import"./globalConfigMixin-BNbqaRx5.js";import"./timeHelper-BT38nsET.js";import"./Spinner-B-aSVz3z.js";import"./Thumbnail-DLjRBBx8.js";import"./index-BO4rcqbh.js";import"./utils.esm-CA3tRshB.js";import"./exports-CsC-x4VI.js";import"./useKeyboardNavigableList-Cfstgo2Q.js";import"./helper-DcGaBm2u.js";import"./DashboardIcon-CPXNa31t.js";import"./AudioNotificationHelper-CDrFIep2.js";import"./Icon-Dtj3LCzD.js";import"./Validators-eX6_8wdj.js";import"./vue-dompurify-html-DZ5r8uTJ.js";import"./module-CGzIBJZi.js";const $={setup(){const{updateUISettings:e}=v(),{enabledLanguages:t}=G(),{accountId:E}=C(),l=f();return{updateUISettings:e,v$:l,enabledLanguages:t,accountId:E}},data(){return{id:"",name:"",locale:"en",domain:"",supportEmail:"",features:{},autoResolveDuration:null,latestChatwootVersion:null}},validations:{name:{required:N},locale:{required:N},autoResolveDuration:{minValue:I(1),maxValue:b(999)}},computed:{...O({globalConfig:"globalConfig/get",getAccount:"accounts/getAccount",uiFlags:"accounts/getUIFlags",isFeatureEnabledonAccount:"accounts/isFeatureEnabledonAccount"}),showAutoResolutionConfig(){return this.isFeatureEnabledonAccount(this.accountId,U.AUTO_RESOLVE_CONVERSATIONS)},hasAnUpdateAvailable(){return S.valid(this.latestChatwootVersion)?S.lt(this.globalConfig.appVersion,this.latestChatwootVersion):!1},languagesSortedByCode(){return[...this.enabledLanguages].sort((t,E)=>t.iso_639_1_code.localeCompare(E.iso_639_1_code))},isUpdating(){return this.uiFlags.isUpdating},featureInboundEmailEnabled(){var e;return!!((e=this.features)!=null&&e.inbound_emails)},featureCustomReplyDomainEnabled(){return this.featureInboundEmailEnabled&&!!this.features.custom_reply_domain},featureCustomReplyEmailEnabled(){return this.featureInboundEmailEnabled&&!!this.features.custom_reply_email},getAccountId(){return this.id.toString()}},mounted(){this.initializeAccount()},methods:{async initializeAccount(){try{const{name:e,locale:t,id:E,domain:l,support_email:n,features:r,auto_resolve_duration:_,latest_chatwoot_version:h}=this.getAccount(this.accountId);this.$root.$i18n.locale=t,this.name=e,this.locale=t,this.id=E,this.domain=l,this.supportEmail=n,this.features=r,this.autoResolveDuration=_,this.latestChatwootVersion=h}catch{}},async updateAccount(){if(this.v$.$touch(),this.v$.$invalid){R(this.$t("GENERAL_SETTINGS.FORM.ERROR"));return}try{await this.$store.dispatch("accounts/update",{locale:this.locale,name:this.name,domain:this.domain,support_email:this.supportEmail,auto_resolve_duration:this.autoResolveDuration}),this.$root.$i18n.locale=this.locale,this.getAccount(this.id).locale=this.locale,this.updateDirectionView(this.locale),R(this.$t("GENERAL_SETTINGS.UPDATE.SUCCESS"))}catch{R(this.$t("GENERAL_SETTINGS.UPDATE.ERROR"))}},updateDirectionView(e){const t=D(e);this.updateUISettings({rtl_view:t})}}},x={class:"flex-grow flex-shrink min-w-0 p-6 overflow-auto"},B={class:"flex flex-row p-4 border-b border-slate-25 dark:border-slate-800"},P={class:"flex-grow-0 flex-shrink-0 flex-[25%] min-w-0 py-4 pr-6 pl-0"},H={class:"text-lg font-medium text-black-900 dark:text-slate-200"},z={class:"p-4 flex-grow-0 flex-shrink-0 flex-[50%]"},q=["placeholder"],j={key:0,class:"message"},W=["value"],J={key:0,class:"message"},K={key:0},Q={key:1},X={key:2},Y=["placeholder"],Z={key:3},ee=["placeholder"],te=["placeholder"],oe={key:0,class:"message"},se={class:"flex flex-row p-4 border-slate-25 dark:border-slate-700 text-black-900 dark:text-slate-300"},ae={class:"flex-grow-0 flex-shrink-0 flex-[25%] min-w-0 py-4 pr-6 pl-0"},le={class:"text-lg font-medium text-black-900 dark:text-slate-200"},ie={class:"p-4 flex-grow-0 flex-shrink-0 flex-[50%]"},ne={class:"p-4 text-sm text-center"},re={key:0},ue={class:"build-id"};function de(e,t,E,l,n,r){const _=T("woot-code"),h=T("woot-submit-button"),L=T("woot-loading-state");return i(),u("div",x,[e.uiFlags.isFetchingItem?d("",!0):(i(),u("form",{key:0,onSubmit:t[7]||(t[7]=M((...s)=>r.updateAccount&&r.updateAccount(...s),["prevent"]))},[o("div",B,[o("div",P,[o("h4",H,a(e.$t("GENERAL_SETTINGS.FORM.GENERAL_SECTION.TITLE")),1),o("p",null,a(e.$t("GENERAL_SETTINGS.FORM.GENERAL_SECTION.NOTE")),1)]),o("div",z,[o("label",{class:A({error:l.v$.name.$error})},[c(a(e.$t("GENERAL_SETTINGS.FORM.NAME.LABEL"))+" ",1),m(o("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>n.name=s),type:"text",placeholder:e.$t("GENERAL_SETTINGS.FORM.NAME.PLACEHOLDER"),onBlur:t[1]||(t[1]=(...s)=>l.v$.name.$touch&&l.v$.name.$touch(...s))},null,40,q),[[p,n.name]]),l.v$.name.$error?(i(),u("span",j,a(e.$t("GENERAL_SETTINGS.FORM.NAME.ERROR")),1)):d("",!0)],2),o("label",{class:A({error:l.v$.locale.$error})},[c(a(e.$t("GENERAL_SETTINGS.FORM.LANGUAGE.LABEL"))+" ",1),m(o("select",{"onUpdate:modelValue":t[2]||(t[2]=s=>n.locale=s)},[(i(!0),u(y,null,V(r.languagesSortedByCode,s=>(i(),u("option",{key:s.iso_639_1_code,value:s.iso_639_1_code},a(s.name),9,W))),128))],512),[[w,n.locale]]),l.v$.locale.$error?(i(),u("span",J,a(e.$t("GENERAL_SETTINGS.FORM.LANGUAGE.ERROR")),1)):d("",!0)],2),r.featureInboundEmailEnabled?(i(),u("label",K,a(e.$t("GENERAL_SETTINGS.FORM.FEATURES.INBOUND_EMAIL_ENABLED")),1)):d("",!0),r.featureCustomReplyDomainEnabled?(i(),u("label",Q,a(e.$t("GENERAL_SETTINGS.FORM.FEATURES.CUSTOM_EMAIL_DOMAIN_ENABLED")),1)):d("",!0),r.featureCustomReplyDomainEnabled?(i(),u("label",X,[c(a(e.$t("GENERAL_SETTINGS.FORM.DOMAIN.LABEL"))+" ",1),m(o("input",{"onUpdate:modelValue":t[3]||(t[3]=s=>n.domain=s),type:"text",placeholder:e.$t("GENERAL_SETTINGS.FORM.DOMAIN.PLACEHOLDER")},null,8,Y),[[p,n.domain]])])):d("",!0),r.featureCustomReplyEmailEnabled?(i(),u("label",Z,[c(a(e.$t("GENERAL_SETTINGS.FORM.SUPPORT_EMAIL.LABEL"))+" ",1),m(o("input",{"onUpdate:modelValue":t[4]||(t[4]=s=>n.supportEmail=s),type:"text",placeholder:e.$t("GENERAL_SETTINGS.FORM.SUPPORT_EMAIL.PLACEHOLDER")},null,8,ee),[[p,n.supportEmail]])])):d("",!0),r.showAutoResolutionConfig?(i(),u("label",{key:4,class:A({error:l.v$.autoResolveDuration.$error})},[c(a(e.$t("GENERAL_SETTINGS.FORM.AUTO_RESOLVE_DURATION.LABEL"))+" ",1),m(o("input",{"onUpdate:modelValue":t[5]||(t[5]=s=>n.autoResolveDuration=s),type:"number",placeholder:e.$t("GENERAL_SETTINGS.FORM.AUTO_RESOLVE_DURATION.PLACEHOLDER"),onBlur:t[6]||(t[6]=(...s)=>l.v$.autoResolveDuration.$touch&&l.v$.autoResolveDuration.$touch(...s))},null,40,te),[[p,n.autoResolveDuration]]),l.v$.autoResolveDuration.$error?(i(),u("span",oe,a(e.$t("GENERAL_SETTINGS.FORM.AUTO_RESOLVE_DURATION.ERROR")),1)):d("",!0)],2)):d("",!0)])]),o("div",se,[o("div",ae,[o("h4",le,a(e.$t("GENERAL_SETTINGS.FORM.ACCOUNT_ID.TITLE")),1),o("p",null,a(e.$t("GENERAL_SETTINGS.FORM.ACCOUNT_ID.NOTE")),1)]),o("div",ie,[g(_,{script:r.getAccountId},null,8,["script"])])]),o("div",ne,[o("div",null,a(`v${e.globalConfig.appVersion}`),1),r.hasAnUpdateAvailable&&e.globalConfig.displayManifest?(i(),u("div",re,a(e.$t("GENERAL_SETTINGS.UPDATE_CHATWOOT",{latestChatwootVersion:n.latestChatwootVersion})),1)):d("",!0),o("div",ue,[o("div",null,a(`Build ${e.globalConfig.gitSha}`),1)])]),g(h,{class:"button nice success button--fixed-top","button-text":e.$t("GENERAL_SETTINGS.SUBMIT"),loading:r.isUpdating},null,8,["button-text","loading"])],32)),e.uiFlags.isFetchingItem?(i(),k(L,{key:1})):d("",!0)])}const ke=F($,[["render",de]]);export{ke as default};
