import{u as g,r as f}from"./index-C2DForDf.js";import{L as C}from"./dashboard-CGLIihvy.js";import{m as B}from"./globalConfig-DaGjiImb.js";import{_ as O,u as p,o as i,n as d,a as v,k as _,p as o,e as E,t as l,f as S,q as L,m as u,g as h,U as T,l as w}from"./_plugin-vue_export-helper-CvYNw_mv.js";const N={components:{LoadingState:C},props:{modelValue:{type:String,default:""}},emits:["update:modelValue"],data(){return{iframeLoading:!0}},computed:{...B({globalConfig:"globalConfig/get"})},mounted(){window.onmessage=t=>{if(typeof t.data!="string"||!t.data.startsWith("chatwoot-csml-editor:update"))return;const e=t.data.replace("chatwoot-csml-editor:update","");this.$emit("update:modelValue",e)}},methods:{onEditorLoad(){const t=document.getElementById("csml-editor--frame"),e={event:"editorContext",data:this.modelValue||""};t.contentWindow.postMessage(JSON.stringify(e),"*"),this.iframeLoading=!1}}},$={class:"csml-editor--container"},R=["src"];function I(t,e,b,r,s,a){const m=p("LoadingState");return i(),d("div",$,[s.iframeLoading?(i(),v(m,{key:0,message:t.$t("AGENT_BOTS.LOADING_EDITOR"),class:"dashboard-app_loading-container"},null,8,["message"])):_("",!0),o("iframe",{id:"csml-editor--frame",src:t.globalConfig.csmlEditorHost,onLoad:e[0]||(e[0]=(...c)=>a.onEditorLoad&&a.onEditorLoad(...c))},null,40,R)])}const M=O(N,[["render",I],["__scopeId","data-v-0c88ea07"]]),A={components:{CsmlMonacoEditor:M},props:{agentBot:{type:Object,default:()=>{}}},emits:["submit"],setup(){return{v$:g()}},validations:{bot:{name:{required:f},csmlContent:{required:f}}},data(){return{bot:{name:this.agentBot.name||"",description:this.agentBot.description||"",csmlContent:this.agentBot.bot_config.csml_content||""}}},methods:{onSubmit(){this.v$.$touch(),!this.v$.$invalid&&this.$emit("submit",{id:this.agentBot.id||"",...this.bot})}}},D={class:"flex flex-col h-auto overflow-auto"},x={class:"flex flex-row"},V={class:"w-[68%]"},y={class:"h-[calc(100vh-56px)] relative"},G={key:0,class:"bg-red-100 dark:bg-red-200 text-white dark:text-white absolute bottom-0 w-full p-2.5 flex items-center text-xs justify-center flex-shrink-0"},k={class:"w-[32%] overflow-auto p-4 h-[calc(100vh-56px)]"},U=["placeholder"],P={key:0,class:"message"},j=["placeholder"];function H(t,e,b,r,s,a){const m=p("CsmlMonacoEditor"),c=p("woot-button");return i(),d("div",D,[o("div",x,[o("div",V,[o("div",y,[E(m,{modelValue:s.bot.csmlContent,"onUpdate:modelValue":e[0]||(e[0]=n=>s.bot.csmlContent=n),class:"w-full h-full"},null,8,["modelValue"]),r.v$.bot.csmlContent.$error?(i(),d("div",G,[o("span",null,l(t.$t("AGENT_BOTS.CSML_BOT_EDITOR.BOT_CONFIG.ERROR")),1)])):_("",!0)])]),o("div",k,[o("form",{class:"flex flex-col justify-between h-full",onSubmit:e[3]||(e[3]=S((...n)=>a.onSubmit&&a.onSubmit(...n),["prevent"]))},[o("div",null,[o("label",{class:L({error:r.v$.bot.name.$error})},[u(l(t.$t("AGENT_BOTS.CSML_BOT_EDITOR.NAME.LABEL"))+" ",1),h(o("input",{"onUpdate:modelValue":e[1]||(e[1]=n=>s.bot.name=n),type:"text",placeholder:t.$t("AGENT_BOTS.CSML_BOT_EDITOR.NAME.PLACEHOLDER")},null,8,U),[[T,s.bot.name]]),r.v$.bot.name.$error?(i(),d("span",P,l(t.$t("AGENT_BOTS.CSML_BOT_EDITOR.NAME.ERROR")),1)):_("",!0)],2),o("label",null,[u(l(t.$t("AGENT_BOTS.CSML_BOT_EDITOR.DESCRIPTION.LABEL"))+" ",1),h(o("textarea",{"onUpdate:modelValue":e[2]||(e[2]=n=>s.bot.description=n),rows:"4",placeholder:t.$t("AGENT_BOTS.CSML_BOT_EDITOR.DESCRIPTION.PLACEHOLDER")},null,8,j),[[T,s.bot.description]])]),E(c,null,{default:w(()=>[u(l(t.$t("AGENT_BOTS.CSML_BOT_EDITOR.SUBMIT")),1)]),_:1})])],32)])])])}const J=O(A,[["render",H]]);export{J as C};
