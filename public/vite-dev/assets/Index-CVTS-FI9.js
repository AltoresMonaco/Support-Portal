import{_ as oe,u as E,o as r,a as g,l as N,p as s,e as c,f as I,q as A,m as F,t as m,g as w,U as se,r as h,c as M,P as ne,n as p,F as k,i as B,H as le,k as ae}from"./_plugin-vue_export-helper-CvYNw_mv.js";import{u as $}from"./index-BaHWIRRA.js";import{A as ie}from"./AddCanned-Cd1FYIf_.js";import{u as de,r as P,m as re}from"./index-C2DForDf.js";import{af as ce,k as ue,o as pe}from"./dashboard-CGLIihvy.js";import{_ as me}from"./BaseSettingsHeader-CxIYpdLq.js";import{u as Ee}from"./globalConfig-DaGjiImb.js";import{u as _e,c as he}from"./mutationHelpers-3VTcoJiD.js";import"./index-Y4OjWrJ-.js";import"./_commonjsHelpers-BosuxZz1.js";import"./axios-CCb-kr4I.js";import"./globalConfigMixin-BNbqaRx5.js";import"./timeHelper-BT38nsET.js";import"./Spinner-B-aSVz3z.js";import"./Thumbnail-DLjRBBx8.js";import"./index-BO4rcqbh.js";import"./utils.esm-CA3tRshB.js";import"./exports-CsC-x4VI.js";import"./vue-router-CNCrM2WK.js";import"./index-BP-sUqpX.js";import"./useKeyboardNavigableList-Cfstgo2Q.js";import"./helper-DcGaBm2u.js";import"./DashboardIcon-CPXNa31t.js";import"./AudioNotificationHelper-CDrFIep2.js";import"./Icon-Dtj3LCzD.js";import"./Validators-eX6_8wdj.js";import"./vue-dompurify-html-DZ5r8uTJ.js";import"./module-CGzIBJZi.js";import"./index-DaWXXnfb.js";import"./BackButton-YZy1EtJv.js";const ve={components:{WootSubmitButton:ce,Modal:ue,WootMessageEditor:pe},props:{id:{type:Number,default:null},edcontent:{type:String,default:""},edshortCode:{type:String,default:""},onClose:{type:Function,default:()=>{}}},setup(){return{v$:de()}},data(){return{editCanned:{showAlert:!1,showLoading:!1},shortCode:this.edshortCode,content:this.edcontent,show:!0}},validations:{shortCode:{required:P,minLength:re(2)},content:{required:P}},computed:{pageTitle(){return`${this.$t("CANNED_MGMT.EDIT.TITLE")} - ${this.edshortCode}`}},methods:{setPageName({name:i}){this.v$.content.$touch(),this.content=i},resetForm(){this.shortCode="",this.content="",this.v$.shortCode.$reset(),this.v$.content.$reset()},editCannedResponse(){this.editCanned.showLoading=!0,this.$store.dispatch("updateCannedResponse",{id:this.id,short_code:this.shortCode,content:this.content}).then(()=>{this.editCanned.showLoading=!1,$(this.$t("CANNED_MGMT.EDIT.API.SUCCESS_MESSAGE")),this.resetForm(),setTimeout(()=>{this.onClose()},10)}).catch(i=>{this.editCanned.showLoading=!1;const o=(i==null?void 0:i.message)||this.$t("CANNED_MGMT.EDIT.API.ERROR_MESSAGE");$(o)})}}},Ce={class:"flex flex-col h-auto overflow-auto"},Te={class:"w-full"},Me=["placeholder"],fe={class:"w-full"},Ne={class:"editor-wrap"},De={class:"flex flex-row justify-end w-full gap-2 px-0 py-2"};function Ae(i,o,v,n,d,C){const _=E("woot-modal-header"),T=E("WootMessageEditor"),a=E("WootSubmitButton"),D=E("Modal");return r(),g(D,{show:d.show,"onUpdate:show":o[5]||(o[5]=l=>d.show=l),"on-close":v.onClose},{default:N(()=>[s("div",Ce,[c(_,{"header-title":C.pageTitle},null,8,["header-title"]),s("form",{class:"flex flex-col w-full",onSubmit:o[4]||(o[4]=I(l=>C.editCannedResponse(),["prevent"]))},[s("div",Te,[s("label",{class:A({error:n.v$.shortCode.$error})},[F(m(i.$t("CANNED_MGMT.EDIT.FORM.SHORT_CODE.LABEL"))+" ",1),w(s("input",{"onUpdate:modelValue":o[0]||(o[0]=l=>d.shortCode=l),type:"text",placeholder:i.$t("CANNED_MGMT.EDIT.FORM.SHORT_CODE.PLACEHOLDER"),onInput:o[1]||(o[1]=(...l)=>n.v$.shortCode.$touch&&n.v$.shortCode.$touch(...l))},null,40,Me),[[se,d.shortCode]])],2)]),s("div",fe,[s("label",{class:A({error:n.v$.content.$error})},m(i.$t("CANNED_MGMT.EDIT.FORM.CONTENT.LABEL")),3),s("div",Ne,[c(T,{modelValue:d.content,"onUpdate:modelValue":o[2]||(o[2]=l=>d.content=l),class:A(["message-editor [&>div]:px-1",{editor_warning:n.v$.content.$error}]),"enable-variables":"","enable-canned-responses":!1,placeholder:i.$t("CANNED_MGMT.EDIT.FORM.CONTENT.PLACEHOLDER"),onBlur:n.v$.content.$touch},null,8,["modelValue","class","placeholder","onBlur"])])]),s("div",De,[c(a,{disabled:n.v$.content.$invalid||n.v$.shortCode.$invalid||d.editCanned.showLoading,"button-text":i.$t("CANNED_MGMT.EDIT.FORM.SUBMIT"),loading:d.editCanned.showLoading},null,8,["disabled","button-text","loading"]),s("button",{class:"button clear",onClick:o[3]||(o[3]=I((...l)=>v.onClose&&v.onClose(...l),["prevent"]))},m(i.$t("CANNED_MGMT.EDIT.CANCEL_BUTTON_TEXT")),1)])],32)])]),_:1},8,["show","on-close"])}const ge=oe(ve,[["render",Ae],["__scopeId","data-v-d4e3fa2b"]]),we={class:"flex-1 overflow-auto"},$e={class:"mt-6 flex-1"},Re={key:1,class:"flex flex-col items-center justify-center h-full text-base text-slate-600 dark:text-slate-300 py-8"},Se={key:2,class:"min-w-full overflow-x-auto divide-y divide-slate-75 dark:divide-slate-700"},Le={key:0},ye={class:"mb-0"},Ge={class:"divide-y divide-slate-50 dark:divide-slate-800 text-slate-700 dark:text-slate-300"},Oe=["title"],be={class:"py-4 pr-4 md:break-all whitespace-normal"},xe={class:"py-4 flex justify-end gap-1"},mt=Object.assign({name:"CannedResponseSettings"},{__name:"Index",setup(i){const o=_e(),v=he(),{t:n}=Ee(),d=h(!1),C=h({}),_=h(!1),T=h(!1),a=h({}),D=h({message:""}),l=h("asc"),R=M(()=>o.getSortedCannedResponses.value(l.value)),U=M(()=>o.getUIFlags.value),H=M(()=>`${n("CANNED_MGMT.DELETE.CONFIRM.YES")} ${a.value.short_code}`),V=M(()=>`${n("CANNED_MGMT.DELETE.CONFIRM.NO")} ${a.value.short_code}`),j=M(()=>` ${a.value.short_code} ? `),W=()=>{l.value=l.value==="asc"?"desc":"asc"},z=async()=>{try{await v.dispatch("getCannedResponse")}catch{}};ne(()=>{z()});const S=e=>{C[a.value.id]=!1,a.value={},D.value.message=e,$(e)},X=()=>{d.value=!0},L=()=>{d.value=!1},q=e=>{_.value=!0,a.value=e},y=()=>{_.value=!1},Y=e=>{T.value=!0,a.value=e},G=()=>{T.value=!1},J=async e=>{try{await v.dispatch("deleteCannedResponse",e),S(n("CANNED_MGMT.DELETE.API.SUCCESS_MESSAGE"))}catch(u){const f=(u==null?void 0:u.message)||n("CANNED_MGMT.DELETE.API.ERROR_MESSAGE");S(f)}},K=()=>{C[a.value.id]=!0,G(),J(a.value.id)},O=M(()=>[n("CANNED_MGMT.LIST.TABLE_HEADER.SHORT_CODE"),n("CANNED_MGMT.LIST.TABLE_HEADER.CONTENT"),n("CANNED_MGMT.LIST.TABLE_HEADER.ACTIONS")]);return(e,u)=>{const f=E("woot-button"),Q=E("woot-loading-state"),Z=E("fluent-icon"),b=E("woot-modal"),ee=E("woot-delete-modal"),x=le("tooltip");return r(),p("div",we,[c(me,{title:e.$t("CANNED_MGMT.HEADER"),description:e.$t("CANNED_MGMT.DESCRIPTION"),"link-text":e.$t("CANNED_MGMT.LEARN_MORE"),"feature-name":"canned_responses"},{actions:N(()=>[c(f,{class:"button nice rounded-md",icon:"add-circle",onClick:X},{default:N(()=>[F(m(e.$t("CANNED_MGMT.HEADER_BTN_TXT")),1)]),_:1})]),_:1},8,["title","description","link-text"]),s("div",$e,[U.value.fetchingList?(r(),g(Q,{key:0,message:e.$t("CANNED_MGMT.LOADING")},null,8,["message"])):R.value.length?(r(),p("table",Se,[s("thead",null,[(r(!0),p(k,null,B(O.value,t=>(r(),p("th",{key:t,class:"py-4 pr-4 text-left font-semibold text-slate-700 dark:text-slate-300 last:text-right"},[t!==O.value[0]?(r(),p("span",Le,m(t),1)):(r(),p("button",{key:1,class:"flex items-center p-0 cursor-pointer",onClick:W},[s("span",ye,m(t),1),c(Z,{class:"ml-2 size-4",icon:l.value==="desc"?"chevron-up":"chevron-down"},null,8,["icon"])]))]))),128))]),s("tbody",Ge,[(r(!0),p(k,null,B(R.value,(t,Ie)=>(r(),p("tr",{key:t.short_code},[s("td",{class:"py-4 pr-4 truncate max-w-xs font-medium",title:t.short_code},m(t.short_code),9,Oe),s("td",be,m(t.content),1),s("td",xe,[w(c(f,{variant:"smooth",size:"tiny","color-scheme":"secondary",icon:"edit",onClick:te=>q(t)},null,8,["onClick"]),[[x,e.$t("CANNED_MGMT.EDIT.BUTTON_TEXT"),void 0,{top:!0}]]),w(c(f,{variant:"smooth","color-scheme":"alert",size:"tiny",icon:"dismiss-circle","class-names":"grey-btn","is-loading":C.value[t.id],onClick:te=>Y(t)},null,8,["is-loading","onClick"]),[[x,e.$t("CANNED_MGMT.DELETE.BUTTON_TEXT"),void 0,{top:!0}]])])]))),128))])])):(r(),p("p",Re,m(e.$t("CANNED_MGMT.LIST.404")),1))]),c(b,{show:d.value,"onUpdate:show":u[0]||(u[0]=t=>d.value=t),"on-close":L},{default:N(()=>[c(ie,{"on-close":L})]),_:1},8,["show"]),c(b,{show:_.value,"onUpdate:show":u[1]||(u[1]=t=>_.value=t),"on-close":y},{default:N(()=>[_.value?(r(),g(ge,{key:0,id:a.value.id,"edshort-code":a.value.short_code,edcontent:a.value.content,"on-close":y},null,8,["id","edshort-code","edcontent"])):ae("",!0)]),_:1},8,["show"]),c(ee,{show:T.value,"onUpdate:show":u[2]||(u[2]=t=>T.value=t),"on-close":G,"on-confirm":K,title:e.$t("CANNED_MGMT.DELETE.CONFIRM.TITLE"),message:e.$t("CANNED_MGMT.DELETE.CONFIRM.MESSAGE"),"message-value":j.value,"confirm-text":H.value,"reject-text":V.value},null,8,["show","title","message","message-value","confirm-text","reject-text"])])}}});export{mt as default};
