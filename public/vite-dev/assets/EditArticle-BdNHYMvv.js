import{m as _}from"./globalConfig-DaGjiImb.js";import{a,u as o}from"./index-BaHWIRRA.js";import{E as C,A as L,a as R}from"./ArticleSettings-u6tJkhap.js";import{S as I}from"./Spinner-B-aSVz3z.js";import{J as T,a9 as c}from"./dashboard-CGLIihvy.js";import{w as f}from"./DashboardIcon-CPXNa31t.js";import{b as P}from"./portalHelper-trLcR8pg.js";import{_ as w,o as r,n as p,p as E,e as n,t as D,a as h,q as M,k as v,u as l}from"./_plugin-vue_export-helper-CvYNw_mv.js";import"./index-Y4OjWrJ-.js";import"./_commonjsHelpers-BosuxZz1.js";import"./utils.esm-CA3tRshB.js";import"./timeHelper-BT38nsET.js";import"./Thumbnail-DLjRBBx8.js";import"./index-BO4rcqbh.js";import"./exports-CsC-x4VI.js";import"./vue-router-CNCrM2WK.js";import"./index-BP-sUqpX.js";import"./mutationHelpers-3VTcoJiD.js";import"./index-DaWXXnfb.js";import"./keyboardEventListenerMixins-Du6EPVcl.js";import"./useKeyboardNavigableList-Cfstgo2Q.js";import"./MultiselectDropdown-Cp046MCC.js";import"./MultiselectDropdownItems-DEUXvTsY.js";import"./axios-CCb-kr4I.js";import"./globalConfigMixin-BNbqaRx5.js";import"./index-C2DForDf.js";import"./helper-DcGaBm2u.js";import"./AudioNotificationHelper-CDrFIep2.js";import"./Validators-eX6_8wdj.js";import"./vue-dompurify-html-DZ5r8uTJ.js";import"./module-CGzIBJZi.js";import"./Icon-Dtj3LCzD.js";const{ARTICLE_STATUS_TYPES:k}=f,N={components:{EditArticleHeader:C,ArticleEditor:L,Spinner:I,ArticleSettings:R},mixins:[T],data(){return{isUpdating:!1,isSaved:!1,showArticleSettings:!0,alertMessage:"",showDeleteConfirmationPopup:!1}},computed:{..._({isFetching:"articles/isFetching"}),article(){return this.$store.getters["articles/articleById"](this.articleId)},articleId(){return this.$route.params.articleSlug},selectedPortalSlug(){return this.$route.params.portalSlug},selectedLocale(){return this.$route.params.locale},portalLink(){const t=this.$route.params.portalSlug;return P(t,this.article.category.slug,this.article.category.locale,this.article.slug)}},mounted(){this.fetchArticleDetails()},methods:{onClickGoBack(){window.history.length>2?this.$router.go(-1):this.$router.push({name:"list_all_locale_articles"})},fetchArticleDetails(){this.$store.dispatch("articles/show",{id:this.articleId,portalSlug:this.selectedPortalSlug})},openDeletePopup(){this.showDeleteConfirmationPopup=!0},closeDeletePopup(){this.showDeleteConfirmationPopup=!1},confirmDeletion(){var t;this.closeDeletePopup(),this.deleteArticle(),a(c.DELETE_ARTICLE,{status:(t=this.article)==null?void 0:t.status})},async saveArticle({...t}){this.isUpdating=!0;try{await this.$store.dispatch("articles/update",{portalSlug:this.selectedPortalSlug,articleId:this.articleId,...t})}catch(i){this.alertMessage=(i==null?void 0:i.message)||this.$t("HELP_CENTER.EDIT_ARTICLE.API.ERROR"),o(this.alertMessage)}finally{setTimeout(()=>{this.isUpdating=!1,this.isSaved=!0},1500)}},async deleteArticle(){try{await this.$store.dispatch("articles/delete",{portalSlug:this.selectedPortalSlug,articleId:this.articleId}),this.alertMessage=this.$t("HELP_CENTER.DELETE_ARTICLE.API.SUCCESS_MESSAGE"),this.$router.push({name:"list_all_locale_articles",params:{portalSlug:this.selectedPortalSlug,locale:this.locale,recentlyDeleted:!0}})}catch(t){this.alertMessage=(t==null?void 0:t.message)||this.$t("HELP_CENTER.DELETE_ARTICLE.API.ERROR_MESSAGE")}finally{o(this.alertMessage)}},async archiveArticle(){try{await this.$store.dispatch("articles/update",{portalSlug:this.selectedPortalSlug,articleId:this.articleId,status:k.ARCHIVE}),this.alertMessage=this.$t("HELP_CENTER.ARCHIVE_ARTICLE.API.SUCCESS"),a(c.ARCHIVE_ARTICLE,{uiFrom:"sidebar"})}catch(t){this.alertMessage=(t==null?void 0:t.message)||this.$t("HELP_CENTER.ARCHIVE_ARTICLE.API.ERROR")}finally{o(this.alertMessage)}},updateMeta(){const t={portalSlug:this.selectedPortalSlug,locale:this.selectedLocale};return this.$store.dispatch("portals/show",t)},openArticleSettings(){this.showArticleSettings=!0},closeArticleSettings(){this.showArticleSettings=!1},showArticleInPortal(){var t;window.open(this.portalLink,"_blank"),a(c.PREVIEW_ARTICLE,{status:(t=this.article)==null?void 0:t.status})}}},H={class:"flex w-full overflow-auto article-container"},y={key:0,class:"h-full p-4 text-base text-center"};function O(t,i,b,U,s,e){const u=l("EditArticleHeader"),m=l("Spinner"),d=l("ArticleEditor"),A=l("ArticleSettings"),g=l("woot-delete-modal");return r(),p("div",H,[E("div",{class:M(["flex-1 flex-shrink-0 px-6 overflow-auto",{"flex-grow-1 flex-shrink-0":s.showArticleSettings}])},[n(u,{"back-button-label":t.$t("HELP_CENTER.HEADER.TITLES.ALL_ARTICLES"),"is-updating":s.isUpdating,"is-saved":s.isSaved,"is-sidebar-open":s.showArticleSettings,onBack:e.onClickGoBack,onOpen:e.openArticleSettings,onClose:e.closeArticleSettings,onShow:e.showArticleInPortal,onUpdateMeta:e.updateMeta},null,8,["back-button-label","is-updating","is-saved","is-sidebar-open","onBack","onOpen","onClose","onShow","onUpdateMeta"]),t.isFetching?(r(),p("div",y,[n(m,{size:""}),E("span",null,D(t.$t("HELP_CENTER.EDIT_ARTICLE.LOADING")),1)])):(r(),h(d,{key:1,"is-settings-sidebar-open":s.showArticleSettings,article:e.article,onSaveArticle:e.saveArticle},null,8,["is-settings-sidebar-open","article","onSaveArticle"]))],2),s.showArticleSettings?(r(),h(A,{key:0,article:e.article,onSaveArticle:e.saveArticle,onDeleteArticle:e.openDeletePopup,onArchiveArticle:e.archiveArticle,onUpdateMeta:e.updateMeta},null,8,["article","onSaveArticle","onDeleteArticle","onArchiveArticle","onUpdateMeta"])):v("",!0),n(g,{show:s.showDeleteConfirmationPopup,"onUpdate:show":i[0]||(i[0]=S=>s.showDeleteConfirmationPopup=S),"on-close":e.closeDeletePopup,"on-confirm":e.confirmDeletion,title:t.$t("HELP_CENTER.DELETE_ARTICLE.MODAL.CONFIRM.TITLE"),message:t.$t("HELP_CENTER.DELETE_ARTICLE.MODAL.CONFIRM.MESSAGE"),"confirm-text":t.$t("HELP_CENTER.DELETE_ARTICLE.MODAL.CONFIRM.YES"),"reject-text":t.$t("HELP_CENTER.DELETE_ARTICLE.MODAL.CONFIRM.NO")},null,8,["show","on-close","on-confirm","title","message","confirm-text","reject-text"])])}const At=w(N,[["render",O]]);export{At as default};
