import{m as C}from"./globalConfig-DaGjiImb.js";import{C as S}from"./ContactInfoPanel-B5ZrvSx2.js";import{_ as E,r as $,c as L,u as n,o,n as d,e as m,p as s,l as w,m as F,t as _,H as x,g as D,a as f,k as N,F as v,i as A}from"./_plugin-vue_export-helper-CvYNw_mv.js";import{u as M}from"./useKeyboardNavigableList-Cfstgo2Q.js";import{o as R}from"./dashboard-CGLIihvy.js";import{T as k}from"./Thumbnail-DLjRBBx8.js";import{u as B}from"./useMessageFormatter-CoQTTzFX.js";import{u as U}from"./timeHelper-BT38nsET.js";import{S as y}from"./Spinner-B-aSVz3z.js";import{S as V}from"./SettingsHeader-fzpbTQki.js";import"./CustomAttributes-CrR_sV2i.js";import"./constants-lVAyZKq6.js";import"./DashboardIcon-CPXNa31t.js";import"./vue-router-CNCrM2WK.js";import"./index-BP-sUqpX.js";import"./AudioNotificationHelper-CDrFIep2.js";import"./index-Y4OjWrJ-.js";import"./_commonjsHelpers-BosuxZz1.js";import"./exports-CsC-x4VI.js";import"./Icon-Dtj3LCzD.js";import"./InboxName-DzICaIqB.js";import"./agentHelper-C7QvnyM_.js";import"./index-Cq2yv_RT.js";import"./mutationHelpers-3VTcoJiD.js";import"./index-DaWXXnfb.js";import"./utils.esm-CA3tRshB.js";import"./ContextMenu-CbEc-VsQ.js";import"./AddLabel-CnIX2z1Y.js";import"./index-BaHWIRRA.js";import"./index-C2DForDf.js";import"./labelColor-5G4vXyDu.js";import"./helper-DcGaBm2u.js";import"./Validators-eX6_8wdj.js";import"./vue-upload-component-ChbSM2aG.js";import"./MultiselectDropdown-Cp046MCC.js";import"./MultiselectDropdownItems-DEUXvTsY.js";import"./vuedraggable.umd-rGNd3eNJ.js";import"./axios-CCb-kr4I.js";import"./globalConfigMixin-BNbqaRx5.js";import"./vue-dompurify-html-DZ5r8uTJ.js";import"./module-CGzIBJZi.js";import"./index-BO4rcqbh.js";import"./BackButton-YZy1EtJv.js";const H={class:"flex flex-col flex-grow p-4 mb-2 overflow-hidden bg-white border border-solid rounded-md shadow-sm border-slate-75 dark:border-slate-700 dark:bg-slate-900 text-slate-700 dark:text-slate-100"},P={class:"flex justify-end w-full"},j={__name:"AddNote",emits:["add"],setup(t,{emit:a}){const l=a,r=$(""),i=L(()=>r.value===""),e=()=>{r.value!==""&&l("add",r.value),r.value=""};return M({"$mod+Enter":{action:()=>e(),allowOnFocusedInput:!0}}),(u,p)=>{const c=n("woot-button");return o(),d("div",H,[m(R,{modelValue:r.value,"onUpdate:modelValue":p[0]||(p[0]=b=>r.value=b),class:"input--note",placeholder:u.$t("NOTES.ADD.PLACEHOLDER"),"enable-suggestions":!1},null,8,["modelValue","placeholder"]),s("div",P,[m(c,{"color-scheme":"warning",title:u.$t("NOTES.ADD.TITLE"),"is-disabled":i.value,onClick:e},{default:w(()=>[F(_(u.$t("NOTES.ADD.BUTTON"))+" "+_("(⌘⏎)"),1)]),_:1},8,["title","is-disabled"])])])}}},z=E(j,[["__scopeId","data-v-75d14068"]]),G={components:{Thumbnail:k},props:{id:{type:Number,default:0},note:{type:String,default:""},user:{type:Object,default:()=>{}},createdAt:{type:Number,default:0}},emits:["delete"],setup(){const{formatMessage:t}=B();return{formatMessage:t}},data(){return{showDeleteModal:!1}},computed:{readableTime(){return U(this.createdAt)},noteAuthor(){return this.user||{}},noteAuthorName(){return this.noteAuthor.name||this.$t("APP_GLOBAL.DELETED_USER")}},methods:{toggleDeleteModal(){this.showDeleteModal=!this.showDeleteModal},onDelete(){this.$emit("delete",this.id)},confirmDeletion(){this.onDelete(),this.closeDelete()},closeDelete(){this.showDeleteModal=!1}}},q={class:"flex flex-col flex-grow p-4 mb-2 overflow-hidden bg-white border border-solid rounded-md shadow-sm border-slate-75 dark:border-slate-700 dark:bg-slate-900 text-slate-700 dark:text-slate-100 note-wrap"},K={class:"flex items-end justify-between gap-1 text-xs"},Q={class:"flex items-center"},Y={class:"my-0 mx-1 p-0.5 flex flex-row gap-1"},J={class:"font-medium text-slate-800 dark:text-slate-100"},W={class:"text-slate-700 dark:text-slate-100"},X={class:"font-medium text-slate-700 dark:text-slate-100"},Z={class:"flex invisible actions"},tt={class:"mt-4 note__content"};function et(t,a,l,r,i,e){const h=n("Thumbnail"),u=n("woot-button"),p=n("woot-delete-modal"),c=x("tooltip"),b=x("dompurify-html");return o(),d("div",q,[s("div",K,[s("div",Q,[m(h,{title:e.noteAuthorName,src:e.noteAuthor.thumbnail,username:e.noteAuthorName,size:"20px"},null,8,["title","src","username"]),s("div",Y,[s("span",J,_(e.noteAuthorName),1),s("span",W,_(t.$t("NOTES.LIST.LABEL")),1),s("span",X,_(e.readableTime),1)])]),s("div",Z,[D(m(u,{variant:"smooth",size:"tiny",icon:"delete","color-scheme":"secondary",onClick:e.toggleDeleteModal},null,8,["onClick"]),[[c,t.$t("NOTES.CONTENT_HEADER.DELETE")]])]),i.showDeleteModal?(o(),f(p,{key:0,show:i.showDeleteModal,"onUpdate:show":a[0]||(a[0]=g=>i.showDeleteModal=g),"on-close":e.closeDelete,"on-confirm":e.confirmDeletion,title:t.$t("DELETE_NOTE.CONFIRM.TITLE"),message:t.$t("DELETE_NOTE.CONFIRM.MESSAGE"),"confirm-text":t.$t("DELETE_NOTE.CONFIRM.YES"),"reject-text":t.$t("DELETE_NOTE.CONFIRM.NO")},null,8,["show","on-close","on-confirm","title","message","confirm-text","reject-text"])):N("",!0)]),D(s("p",tt,null,512),[[b,r.formatMessage(l.note||"")]])])}const ot=E(G,[["render",et],["__scopeId","data-v-3954e04b"]]),st={components:{AddNote:z,ContactNote:ot,Spinner:y},props:{notes:{type:Array,default:()=>[]},isFetching:{type:Boolean,default:!1}},emits:["add","edit","delete"],methods:{onAddNote(t){this.$emit("add",t)},onEditNote(t){this.$emit("edit",t)},onDeleteNote(t){this.$emit("delete",t)}}},nt={key:0,class:"text-center p-4 text-base"},at={key:1,class:"text-center p-4 text-base"};function rt(t,a,l,r,i,e){const h=n("AddNote"),u=n("ContactNote"),p=n("Spinner");return o(),d("div",null,[m(h,{onAdd:e.onAddNote},null,8,["onAdd"]),(o(!0),d(v,null,A(l.notes,c=>(o(),f(u,{id:c.id,key:c.id,note:c.content,user:c.user,"created-at":c.created_at,onEdit:e.onEditNote,onDelete:e.onDeleteNote},null,8,["id","note","user","created-at","onEdit","onDelete"]))),128)),l.isFetching?(o(),d("div",nt,[m(p,{size:""}),s("span",null,_(t.$t("NOTES.FETCHING_NOTES")),1)])):l.notes.length?N("",!0):(o(),d("div",at,[s("span",null,_(t.$t("NOTES.NOT_AVAILABLE")),1)]))])}const ct=E(st,[["render",rt]]),lt={components:{NoteList:ct},props:{contactId:{type:Number,required:!0}},computed:{...C({uiFlags:"contactNotes/getUIFlags"}),notes(){return this.$store.getters["contactNotes/getAllNotesByContact"](this.contactId)}},mounted(){this.fetchContactNotes()},methods:{fetchContactNotes(){const{contactId:t}=this;t&&this.$store.dispatch("contactNotes/get",{contactId:t})},onAdd(t){const{contactId:a}=this;this.$store.dispatch("contactNotes/create",{content:t,contactId:a})},onDelete(t){const{contactId:a}=this;this.$store.dispatch("contactNotes/delete",{noteId:t,contactId:a})}}};function it(t,a,l,r,i,e){const h=n("NoteList");return o(),f(h,{"is-fetching":t.uiFlags.isFetching,notes:e.notes,onAdd:e.onAdd,onDelete:e.onDelete},null,8,["is-fetching","notes","onAdd","onDelete"])}const dt=E(lt,[["render",it]]),mt={components:{ContactInfoPanel:S,ContactNotes:dt,SettingsHeader:V,Spinner:y,Thumbnail:k},props:{contactId:{type:[String,Number],required:!0}},data(){return{selectedTabIndex:0}},computed:{...C({uiFlags:"contacts/getUIFlags"}),tabs(){return[{key:0,name:this.$t("NOTES.HEADER.TITLE")}]},showEmptySearchResult(){return!!this.searchQuery&&this.records.length===0},contact(){return this.$store.getters["contacts/getContact"](this.contactId)},backUrl(){return`/app/accounts/${this.$route.params.accountId}/contacts`}},mounted(){this.fetchContactDetails()},methods:{onClickTabChange(t){this.selectedTabIndex=t},fetchContactDetails(){const{contactId:t}=this;this.$store.dispatch("contacts/show",{id:t})}}},ut={class:"flex justify-between flex-col h-full m-0 flex-1 bg-white dark:bg-slate-900"},ht={key:0,class:"text-center p-4 text-base h-full"},pt={key:1,class:"overflow-hidden flex-1 min-w-0"},_t={class:"flex flex-wrap ml-auto mr-auto max-w-full h-full"},ft={class:"w-3/4 h-full"},bt={class:"bg-slate-25 dark:bg-slate-800 h-[calc(100%-40px)] p-4 overflow-auto"};function Nt(t,a,l,r,i,e){const h=n("Thumbnail"),u=n("SettingsHeader"),p=n("Spinner"),c=n("ContactInfoPanel"),b=n("woot-tabs-item"),g=n("woot-tabs"),I=n("ContactNotes");return o(),d("div",ut,[m(u,{"button-route":"new","header-title":e.contact.name,"show-back-button":"","back-button-label":t.$t("CONTACT_PROFILE.BACK_BUTTON"),"back-url":e.backUrl,"show-new-button":!1},{default:w(()=>[e.contact.thumbnail?(o(),f(h,{key:0,src:e.contact.thumbnail,username:e.contact.name,size:"32px",class:"mr-2 rtl:mr-0 rtl:ml-2"},null,8,["src","username"])):N("",!0)]),_:1},8,["header-title","back-button-label","back-url"]),t.uiFlags.isFetchingItem?(o(),d("div",ht,[m(p,{size:""}),s("span",null,_(t.$t("CONTACT_PROFILE.LOADING")),1)])):e.contact.id?(o(),d("div",pt,[s("div",_t,[m(c,{"show-close-button":!1,"show-avatar":!1,contact:e.contact},null,8,["contact"]),s("div",ft,[m(g,{index:i.selectedTabIndex,onChange:e.onClickTabChange},{default:w(()=>[(o(!0),d(v,null,A(e.tabs,(T,O)=>(o(),f(b,{key:T.key,index:O,name:T.name,"show-badge":!1},null,8,["index","name"]))),128))]),_:1},8,["index","onChange"]),s("div",bt,[i.selectedTabIndex===0?(o(),f(I,{key:0,"contact-id":Number(l.contactId)},null,8,["contact-id"])):N("",!0)])])])])):N("",!0)])}const le=E(mt,[["render",Nt]]);export{le as default};
