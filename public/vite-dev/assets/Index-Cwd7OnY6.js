import{m as $}from"./globalConfig-DaGjiImb.js";import{u as I}from"./index-BaHWIRRA.js";import{u as L,r as N,b as v}from"./index-C2DForDf.js";import{_ as G,u as i,o as a,a as E,l as T,p as r,e as p,f as P,q as O,m as R,t as u,H,n as c,g as f,k as h,F as b,i as w}from"./_plugin-vue_export-helper-CvYNw_mv.js";import{g as y}from"./globalConfigMixin-BNbqaRx5.js";import{_ as C}from"./BaseSettingsHeader-CxIYpdLq.js";import"./index-Y4OjWrJ-.js";import"./_commonjsHelpers-BosuxZz1.js";import"./mutationHelpers-3VTcoJiD.js";import"./vue-router-CNCrM2WK.js";import"./index-BP-sUqpX.js";import"./index-DaWXXnfb.js";import"./BackButton-YZy1EtJv.js";import"./dashboard-CGLIihvy.js";import"./axios-CCb-kr4I.js";import"./timeHelper-BT38nsET.js";import"./Spinner-B-aSVz3z.js";import"./Thumbnail-DLjRBBx8.js";import"./index-BO4rcqbh.js";import"./utils.esm-CA3tRshB.js";import"./exports-CsC-x4VI.js";import"./useKeyboardNavigableList-Cfstgo2Q.js";import"./helper-DcGaBm2u.js";import"./DashboardIcon-CPXNa31t.js";import"./AudioNotificationHelper-CDrFIep2.js";import"./Icon-Dtj3LCzD.js";import"./Validators-eX6_8wdj.js";import"./vue-dompurify-html-DZ5r8uTJ.js";import"./module-CGzIBJZi.js";const k={props:{show:{type:Boolean,default:!1},mode:{type:String,default:"create"},selectedAppData:{type:Object,default:()=>({})}},emits:["close"],setup(){return{v$:L()}},validations:{app:{title:{required:N},content:{type:{required:N},url:{required:N,url:v}}}},data(){return{isLoading:!1,app:{title:"",content:{type:"frame",url:""}}}},computed:{header(){return this.$t(`INTEGRATION_SETTINGS.DASHBOARD_APPS.${this.mode}.HEADER`)},submitButtonLabel(){return this.$t(`INTEGRATION_SETTINGS.DASHBOARD_APPS.${this.mode}.FORM_SUBMIT`)}},mounted(){this.mode==="UPDATE"&&this.selectedAppData&&(this.app.title=this.selectedAppData.title,this.app.content=this.selectedAppData.content[0])},methods:{closeModal(){this.app={title:"",content:{type:"frame",url:""}},this.$emit("close")},async submit(){try{if(this.v$.$touch(),this.v$.$invalid)return;const e=this.mode.toLowerCase(),t={title:this.app.title,content:[this.app.content]};e==="update"&&(t.id=this.selectedAppData.id),this.isLoading=!0,await this.$store.dispatch(`dashboardApps/${e}`,t),I(this.$t(`INTEGRATION_SETTINGS.DASHBOARD_APPS.${this.mode}.API_SUCCESS`)),this.closeModal()}catch{I(this.$t(`INTEGRATION_SETTINGS.DASHBOARD_APPS.${this.mode}.API_ERROR`))}finally{this.isLoading=!1}}}},M={class:"flex flex-col h-auto overflow-auto"},F={class:"flex flex-row justify-end w-full gap-2 px-0 py-2"};function x(e,t,n,l,o,s){const _=i("woot-modal-header"),m=i("woot-input"),S=i("woot-button"),D=i("woot-modal");return a(),E(D,{show:n.show,"on-close":s.closeModal},{default:T(()=>[r("div",M,[p(_,{"header-title":s.header},null,8,["header-title"]),r("form",{class:"w-full",onSubmit:t[2]||(t[2]=P((...d)=>s.submit&&s.submit(...d),["prevent"]))},[p(m,{modelValue:o.app.title,"onUpdate:modelValue":t[0]||(t[0]=d=>o.app.title=d),class:O([{error:l.v$.app.title.$error},"w-full"]),label:e.$t("INTEGRATION_SETTINGS.DASHBOARD_APPS.FORM.TITLE_LABEL"),placeholder:e.$t("INTEGRATION_SETTINGS.DASHBOARD_APPS.FORM.TITLE_PLACEHOLDER"),error:l.v$.app.title.$error?e.$t("INTEGRATION_SETTINGS.DASHBOARD_APPS.FORM.TITLE_ERROR"):null,"data-testid":"app-title",onInput:l.v$.app.title.$touch,onBlur:l.v$.app.title.$touch},null,8,["modelValue","class","label","placeholder","error","onInput","onBlur"]),p(m,{modelValue:o.app.content.url,"onUpdate:modelValue":t[1]||(t[1]=d=>o.app.content.url=d),class:O([{error:l.v$.app.content.url.$error},"w-full"]),label:e.$t("INTEGRATION_SETTINGS.DASHBOARD_APPS.FORM.URL_LABEL"),placeholder:e.$t("INTEGRATION_SETTINGS.DASHBOARD_APPS.FORM.URL_PLACEHOLDER"),error:l.v$.app.content.url.$error?e.$t("INTEGRATION_SETTINGS.DASHBOARD_APPS.FORM.URL_ERROR"):null,"data-testid":"app-url",onInput:l.v$.app.content.url.$touch,onBlur:l.v$.app.content.url.$touch},null,8,["modelValue","class","label","placeholder","error","onInput","onBlur"]),r("div",F,[p(S,{"is-loading":o.isLoading,"is-disabled":l.v$.$invalid,"data-testid":"label-submit"},{default:T(()=>[R(u(s.submitButtonLabel),1)]),_:1},8,["is-loading","is-disabled"]),p(S,{class:"button clear",onClick:P(s.closeModal,["prevent"])},{default:T(()=>[R(u(e.$t("INTEGRATION_SETTINGS.DASHBOARD_APPS.CREATE.FORM_CANCEL")),1)]),_:1},8,["onClick"])])],32)])]),_:1},8,["show","on-close"])}const U=G(k,[["render",x]]),V={class:"max-w-full py-1"},j=["title"],z=["title"],q={class:"flex gap-1 py-4 pr-4 text-sm sm:pr-0 justify-end"},X={__name:"DashboardAppsRow",props:{app:{type:Object,default:()=>({})}},emits:["edit","delete"],setup(e){return(t,n)=>{const l=i("woot-button"),o=H("tooltip");return a(),c("tr",V,[r("td",{class:"py-4 pr-4 text-sm w-40 max-w-[10rem] truncate",title:e.app.title},u(e.app.title),9,j),r("td",{class:"max-w-lg py-4 pr-4 text-sm truncate",title:e.app.content[0].url},u(e.app.content[0].url),9,z),r("td",q,[f(p(l,{variant:"smooth",size:"tiny","color-scheme":"secondary","class-names":"grey-btn",icon:"edit",onClick:n[0]||(n[0]=s=>t.$emit("edit",e.app))},null,512),[[o,t.$t("INTEGRATION_SETTINGS.DASHBOARD_APPS.LIST.EDIT_TOOLTIP"),void 0,{top:!0}]]),f(p(l,{variant:"smooth","color-scheme":"alert",size:"tiny",icon:"dismiss-circle","class-names":"grey-btn",onClick:n[1]||(n[1]=s=>t.$emit("delete",e.app))},null,512),[[o,t.$t("INTEGRATION_SETTINGS.DASHBOARD_APPS.LIST.DELETE_TOOLTIP"),void 0,{top:!0}]])])])}}},Y={components:{BaseSettingsHeader:C,DashboardAppModal:U,DashboardAppsRow:X},mixins:[y],data(){return{loading:{},showDashboardAppPopup:!1,showDeleteConfirmationPopup:!1,selectedApp:{},mode:"CREATE"}},computed:{...$({records:"dashboardApps/getRecords",uiFlags:"dashboardApps/getUIFlags"}),tableHeaders(){return[this.$t("INTEGRATION_SETTINGS.DASHBOARD_APPS.LIST.TABLE_HEADER.NAME"),this.$t("INTEGRATION_SETTINGS.DASHBOARD_APPS.LIST.TABLE_HEADER.ENDPOINT")]}},mounted(){this.$store.dispatch("dashboardApps/get")},methods:{toggleDashboardAppPopup(){this.showDashboardAppPopup=!this.showDashboardAppPopup,this.selectedApp={}},openDeletePopup(e){this.showDeleteConfirmationPopup=!0,this.selectedApp=e},openCreatePopup(){this.mode="CREATE",this.selectedApp={},this.showDashboardAppPopup=!0},closeDeletePopup(){this.showDeleteConfirmationPopup=!1},editApp(e){this.loading[e.id]=!0,this.mode="UPDATE",this.selectedApp=e,this.showDashboardAppPopup=!0},confirmDeletion(){this.loading[this.selectedApp.id]=!0,this.closeDeletePopup(),this.deleteApp(this.selectedApp.id)},async deleteApp(e){try{await this.$store.dispatch("dashboardApps/delete",e),I(this.$t("INTEGRATION_SETTINGS.DASHBOARD_APPS.DELETE.API_SUCCESS"))}catch{I(this.$t("INTEGRATION_SETTINGS.DASHBOARD_APPS.DELETE.API_ERROR"))}}}},J={class:"flex flex-col flex-1 gap-8 overflow-auto"},K={class:"w-full overflow-x-auto text-slate-700 dark:text-slate-200"},Q={key:0,class:"flex flex-col items-center justify-center h-full"},W={key:2,class:"min-w-full divide-y divide-slate-75 dark:divide-slate-700"},Z={class:"divide-y divide-slate-50 dark:divide-slate-800"};function ee(e,t,n,l,o,s){const _=i("woot-button"),m=i("BaseSettingsHeader"),S=i("woot-loading-state"),D=i("DashboardAppsRow"),d=i("DashboardAppModal"),g=i("woot-delete-modal");return a(),c("div",J,[p(m,{title:e.$t("INTEGRATION_SETTINGS.DASHBOARD_APPS.TITLE"),description:e.$t("INTEGRATION_SETTINGS.DASHBOARD_APPS.DESCRIPTION"),"link-text":e.$t("INTEGRATION_SETTINGS.DASHBOARD_APPS.LEARN_MORE"),"feature-name":"dashboard_apps","back-button-label":e.$t("INTEGRATION_SETTINGS.HEADER")},{actions:T(()=>[p(_,{class:"rounded-md button nice",icon:"add-circle",onClick:s.openCreatePopup},{default:T(()=>[R(u(e.$t("INTEGRATION_SETTINGS.DASHBOARD_APPS.HEADER_BTN_TXT")),1)]),_:1},8,["onClick"])]),_:1},8,["title","description","link-text","back-button-label"]),r("div",K,[!e.uiFlags.isFetching&&!e.records.length?(a(),c("p",Q,u(e.$t("INTEGRATION_SETTINGS.DASHBOARD_APPS.LIST.404")),1)):h("",!0),e.uiFlags.isFetching?(a(),E(S,{key:1,message:e.$t("INTEGRATION_SETTINGS.DASHBOARD_APPS.LIST.LOADING")},null,8,["message"])):h("",!0),!e.uiFlags.isFetching&&e.records.length?(a(),c("table",W,[r("thead",null,[(a(!0),c(b,null,w(s.tableHeaders,A=>(a(),c("th",{key:A,class:"py-4 pr-4 font-semibold text-left text-slate-700 dark:text-slate-300"},u(A),1))),128))]),r("tbody",Z,[(a(!0),c(b,null,w(e.records,(A,B)=>(a(),E(D,{key:A.id,index:B,app:A,onEdit:s.editApp,onDelete:s.openDeletePopup},null,8,["index","app","onEdit","onDelete"]))),128))])])):h("",!0)]),o.showDashboardAppPopup?(a(),E(d,{key:0,show:o.showDashboardAppPopup,mode:o.mode,"selected-app-data":o.selectedApp,onClose:s.toggleDashboardAppPopup},null,8,["show","mode","selected-app-data","onClose"])):h("",!0),p(g,{show:o.showDeleteConfirmationPopup,"onUpdate:show":t[0]||(t[0]=A=>o.showDeleteConfirmationPopup=A),"on-close":s.closeDeletePopup,"on-confirm":s.confirmDeletion,title:e.$t("INTEGRATION_SETTINGS.DASHBOARD_APPS.DELETE.TITLE"),message:e.$t("INTEGRATION_SETTINGS.DASHBOARD_APPS.DELETE.MESSAGE",{appName:o.selectedApp.title}),"confirm-text":e.$t("INTEGRATION_SETTINGS.DASHBOARD_APPS.DELETE.CONFIRM_YES"),"reject-text":e.$t("INTEGRATION_SETTINGS.DASHBOARD_APPS.DELETE.CONFIRM_NO")},null,8,["show","on-close","on-confirm","title","message","confirm-text","reject-text"])])}const ge=G(Y,[["render",ee]]);export{ge as default};
