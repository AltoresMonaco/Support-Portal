import{k as D,i as R,m as B}from"./globalConfig-DaGjiImb.js";import{a as w,u as O}from"./index-BaHWIRRA.js";import{r as $,I as C,u as M}from"./dashboard-CGLIihvy.js";import{w as _}from"./DashboardIcon-CPXNa31t.js";import{_ as y,o,n as a,p as s,k as c,u as d,e as p,t as m,a as f,l as L,F as v,i as N,f as S,q as g,H as F,g as T}from"./_plugin-vue_export-helper-CvYNw_mv.js";import{_ as U}from"./ContextMenu-CbEc-VsQ.js";import{T as P}from"./Thumbnail-DLjRBBx8.js";import{u as X,v as Y}from"./timeHelper-BT38nsET.js";import{s as z}from"./CustomSnoozeModal-C-8tQQe1.js";import{_ as V,a as Z}from"./CmdBarConversationSnooze-CfVb4fGQ.js";import"./index-Y4OjWrJ-.js";import"./_commonjsHelpers-BosuxZz1.js";import"./axios-CCb-kr4I.js";import"./mutationHelpers-3VTcoJiD.js";import"./vue-router-CNCrM2WK.js";import"./index-BP-sUqpX.js";import"./index-DaWXXnfb.js";import"./globalConfigMixin-BNbqaRx5.js";import"./index-C2DForDf.js";import"./useKeyboardNavigableList-Cfstgo2Q.js";import"./helper-DcGaBm2u.js";import"./utils.esm-CA3tRshB.js";import"./Spinner-B-aSVz3z.js";import"./AudioNotificationHelper-CDrFIep2.js";import"./exports-CsC-x4VI.js";import"./Validators-eX6_8wdj.js";import"./vue-dompurify-html-DZ5r8uTJ.js";import"./module-CGzIBJZi.js";import"./index-BO4rcqbh.js";import"./Icon-Dtj3LCzD.js";import"./index-CbMJaKeB.js";import"./index.es-CaHyKWHu.js";import"./events-Ch9G9t6H.js";const j={props:{priority:{type:String,default:""}},data(){return{CONVERSATION_PRIORITY:D}}},H={class:"inline-flex items-center justify-center rounded-md"},K={key:0,class:"h-4 w-4",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},W={key:1,class:"h-4 w-4",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},G={key:2,class:"h-4 w-4",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},q={key:3,class:"h-4 w-4",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function J(t,e,r,u,n,i){return o(),a("div",H,[r.priority===n.CONVERSATION_PRIORITY.HIGH?(o(),a("svg",K,e[0]||(e[0]=[s("rect",{x:"4",y:"12",width:"4",height:"8",rx:"1",fill:"#FFC291"},null,-1),s("rect",{x:"10",y:"8",width:"4",height:"12",rx:"1",fill:"#FFC291"},null,-1),s("rect",{x:"16",y:"4",width:"4",height:"16",rx:"1",fill:"#FFC291"},null,-1)]))):c("",!0),r.priority===n.CONVERSATION_PRIORITY.LOW?(o(),a("svg",W,e[1]||(e[1]=[s("rect",{x:"4",y:"12",width:"4",height:"8",rx:"1",fill:"#FFC291"},null,-1),s("rect",{x:"10",y:"8",width:"4",height:"12",rx:"1",fill:"#DDDDDD"},null,-1),s("rect",{x:"16",y:"4",width:"4",height:"16",rx:"1",fill:"#DDDDDD"},null,-1)]))):c("",!0),r.priority===n.CONVERSATION_PRIORITY.MEDIUM?(o(),a("svg",G,e[2]||(e[2]=[s("rect",{x:"4",y:"12",width:"4",height:"8",rx:"1",fill:"#FFC291"},null,-1),s("rect",{x:"10",y:"8",width:"4",height:"12",rx:"1",fill:"#FFC291"},null,-1),s("rect",{x:"16",y:"4",width:"4",height:"16",rx:"1",fill:"#DDDDDD"},null,-1)]))):c("",!0),r.priority===n.CONVERSATION_PRIORITY.URGENT?(o(),a("svg",q,e[3]||(e[3]=[s("rect",{x:"4",y:"12",width:"4",height:"8",rx:"1",fill:"#E5484D"},null,-1),s("rect",{x:"10",y:"8",width:"4",height:"12",rx:"1",fill:"#E5484D"},null,-1),s("rect",{x:"16",y:"4",width:"4",height:"16",rx:"1",fill:"#E5484D"},null,-1)]))):c("",!0)])}const Q=y(j,[["render",J]]),tt={props:{status:{type:String,default:""}},data(){return{CONVERSATION_STATUS:R}}},et={class:"inline-flex items-center justify-center rounded-md"},it={key:0,class:"h-3.5 w-3.5",width:"18",height:"18",viewBox:"0 0 18 18",fill:"none",xmlns:"http://www.w3.org/2000/svg"},st={key:1,class:"h-3.5 w-3.5",width:"19",height:"19",viewBox:"0 0 19 19",fill:"none",xmlns:"http://www.w3.org/2000/svg"},nt={key:2,class:"h-3.5 w-3.5",width:"18",height:"18",viewBox:"0 0 18 18",fill:"none",xmlns:"http://www.w3.org/2000/svg"},ot={key:3,class:"h-3.5 w-3.5",fill:"none",xmlns:"http://www.w3.org/2000/svg",viewBox:"3 3 17.92 17.92"};function rt(t,e,r,u,n,i){return o(),a("div",et,[r.status===n.CONVERSATION_STATUS.PENDING?(o(),a("svg",it,e[0]||(e[0]=[s("path",{d:"M8.1 0.0449978V1.8558C4.5486 2.2986 1.8 5.328 1.8 9C1.8 12.9762 5.0238 16.2 9 16.2C10.6641 16.2 12.195 15.6357 13.4154 14.688L14.6961 15.9687C13.1445 17.2377 11.16 18 9 18C4.0293 18 0 13.9707 0 9C0 4.3335 3.5523 0.495898 8.1 0.0449978ZM17.955 9.9C17.775 11.7099 17.0604 13.3623 15.9687 14.6952L14.688 13.4154C15.462 12.4191 15.9804 11.2149 16.1442 9.9H17.9559H17.955ZM9.9018 0.0449978C14.1534 0.467098 17.5338 3.8484 17.9568 8.1H16.1451C15.7392 4.8438 13.158 2.2626 9.9018 1.8558V0.0440979V0.0449978Z",class:"fill-[#B9BBC6]"},null,-1)]))):c("",!0),r.status===n.CONVERSATION_STATUS.OPEN?(o(),a("svg",st,e[1]||(e[1]=[s("path",{d:"M9.375 18.875C4.19733 18.875 0 14.6776 0 9.5C0 4.32233 4.19733 0.125 9.375 0.125C14.5526 0.125 18.75 4.32233 18.75 9.5C18.75 14.6776 14.5526 18.875 9.375 18.875ZM9.375 17C13.5172 17 16.875 13.6422 16.875 9.5C16.875 5.35786 13.5172 2 9.375 2C5.23286 2 1.875 5.35786 1.875 9.5C1.875 13.6422 5.23286 17 9.375 17Z",class:"fill-[#ED8A5C]"},null,-1)]))):c("",!0),r.status===n.CONVERSATION_STATUS.SNOOZED?(o(),a("svg",nt,e[2]||(e[2]=[s("path",{d:"M9 18C4.0293 18 0 13.9707 0 9C0 4.0293 4.0293 0 9 0C13.9707 0 18 4.0293 18 9C18 13.9707 13.9707 18 9 18ZM2.9961 12.9825C3.58766 13.8676 4.36812 14.6105 5.28129 15.1577C6.19446 15.7049 7.21761 16.0428 8.27707 16.147C9.33652 16.2513 10.4059 16.1193 11.4082 15.7606C12.4105 15.4019 13.3208 14.8254 14.0736 14.0726C14.8263 13.3198 15.4027 12.4094 15.7613 11.4071C16.12 10.4047 16.2518 9.33532 16.1475 8.27588C16.0431 7.21644 15.7052 6.19332 15.1579 5.2802C14.6106 4.36707 13.8676 3.58668 12.9825 2.9952C13.3706 4.3796 13.383 5.84237 13.0186 7.23318C12.6542 8.62399 11.926 9.89269 10.9089 10.9089C9.89277 11.9258 8.62423 12.6539 7.23359 13.0183C5.84296 13.3828 4.38037 13.3704 2.9961 12.9825Z",class:"fill-[#0B68CB]"},null,-1)]))):c("",!0),r.status===n.CONVERSATION_STATUS.RESOLVED?(o(),a("svg",ot,e[3]||(e[3]=[s("path",{d:"M11.96 20.92C7.01152 20.92 3 16.9084 3 11.96C3 7.01152 7.01152 3 11.96 3C16.9084 3 20.92 7.01152 20.92 11.96C20.92 16.9084 16.9084 20.92 11.96 20.92ZM11.96 19.128C15.9188 19.128 19.128 15.9188 19.128 11.96C19.128 8.00122 15.9188 4.792 11.96 4.792C8.00122 4.792 4.792 8.00122 4.792 11.96C4.792 15.9188 8.00122 19.128 11.96 19.128Z",class:"fill-[#5BB98C]"},null,-1),s("path",{d:"M11.9599 17.9333C15.2589 17.9333 17.9332 15.2589 17.9332 11.96C17.9332 8.66098 15.2589 5.98663 11.9599 5.98663C8.66092 5.98663 5.98657 8.66098 5.98657 11.96C5.98657 15.2589 8.66092 17.9333 11.9599 17.9333Z",class:"fill-[#5BB98C]"},null,-1)]))):c("",!0)])}const at=y(tt,[["render",rt]]),lt={props:{inbox:{type:Object,default:()=>{}},conversationId:{type:Number,default:0}},computed:{inboxIcon(){const{phone_number:t,channel_type:e}=this.inbox;return $(e,t)}}},ct={class:"inline-flex items-center rounded-[4px] border border-slate-100 dark:border-slate-700/50 divide-x divide-slate-100 dark:divide-slate-700/50 bg-none"},dt={key:0,class:"flex items-center gap-0.5 py-0.5 px-1.5"},ut={class:"font-medium text-slate-600 dark:text-slate-200 text-xs"},ht={class:"flex items-center py-0.5 px-1.5"},_t={class:"font-medium text-slate-600 dark:text-slate-200 text-xs"};function mt(t,e,r,u,n,i){const h=d("fluent-icon");return o(),a("div",ct,[r.inbox?(o(),a("div",dt,[p(h,{class:"text-slate-600 dark:text-slate-300",icon:i.inboxIcon,size:"14"},null,8,["icon"]),s("span",ut,m(r.inbox.name),1)])):c("",!0),s("div",ht,[s("span",_t,m(r.conversationId),1)])])}const xt=y(lt,[["render",mt]]),pt={role:"button",class:"flex items-center w-full h-8 px-2 py-1 overflow-hidden text-xs font-medium rounded-md cursor-pointer text-slate-800 dark:text-slate-100 whitespace-nowrap text-ellipsis hover:text-woot-600 dark:hover:text-woot-500"},A={__name:"MenuItem",props:{label:{type:String,default:""}},setup(t){return(e,r)=>(o(),a("div",pt,m(t.label),1))}},ft={components:{MenuItem:A,ContextMenu:U},props:{contextMenuPosition:{type:Object,default:()=>({})},menuItems:{type:Array,default:()=>[]}},emits:["close","selectAction"],methods:{handleClose(){this.$emit("close")},onMenuItemClick(t){this.$emit("selectAction",t),this.handleClose()}}},yt={class:"bg-white dark:bg-slate-900 w-40 py-1 border shadow-md border-slate-100 dark:border-slate-700/50 rounded-xl"};function It(t,e,r,u,n,i){const h=d("MenuItem"),l=d("ContextMenu");return o(),f(l,{x:r.contextMenuPosition.x,y:r.contextMenuPosition.y,onClose:i.handleClose},{default:L(()=>[s("div",yt,[(o(!0),a(v,null,N(r.menuItems,x=>(o(),f(h,{key:x.key,label:x.label,onClick:S(b=>i.onMenuItemClick(x.key),["stop"])},null,8,["label","onClick"]))),128))])]),_:1},8,["x","y","onClose"])}const bt=y(ft,[["render",It]]),kt={components:{PriorityIcon:Q,InboxContextMenu:bt,StatusIcon:at,InboxNameAndId:xt,Thumbnail:P},props:{notificationItem:{type:Object,default:()=>{}},active:{type:Boolean,default:!1}},emits:["contextMenuClose","contextMenuOpen","markNotificationAsRead","markNotificationAsUnRead","deleteNotification"],data(){return{isContextMenuOpen:!1,contextMenuPosition:{x:null,y:null}}},computed:{primaryActor(){var t;return(t=this.notificationItem)==null?void 0:t.primary_actor},inbox(){return this.$store.getters["inboxes/getInbox"](this.primaryActor.inbox_id)},isUnread(){var t;return!((t=this.notificationItem)!=null&&t.read_at)},meta(){var t;return(t=this.primaryActor)==null?void 0:t.meta},assigneeMeta(){var t;return(t=this.meta)==null?void 0:t.assignee},pushTitle(){return this.$t(`INBOX.TYPES.${this.notificationItem.notification_type.toUpperCase()}`)},lastActivityAt(){var e;const t=X((e=this.notificationItem)==null?void 0:e.last_activity_at);return Y(t,!0)},menuItems(){const t=[{key:"delete",label:this.$t("INBOX.MENU_ITEM.DELETE")}];return this.isUnread?t.push({key:"mark_as_read",label:this.$t("INBOX.MENU_ITEM.MARK_AS_READ")}):t.push({key:"mark_as_unread",label:this.$t("INBOX.MENU_ITEM.MARK_AS_UNREAD")}),t},snoozedUntilTime(){const{snoozed_until:t}=this.notificationItem;return t},snoozedDisplayText(){return this.snoozedUntilTime?`${this.$t("INBOX.LIST.SNOOZED_UNTIL")} ${z(this.snoozedUntilTime)}`:""}},unmounted(){this.closeContextMenu()},methods:{openConversation(t){const{id:e,primary_actor_id:r,primary_actor_type:u,primary_actor:{inbox_id:n},notification_type:i}=t;this.$route.params.notification_id!==e&&(w(C.OPEN_CONVERSATION_VIA_INBOX,{notificationType:i}),this.$store.dispatch("notifications/read",{id:e,primaryActorId:r,primaryActorType:u,unreadCount:this.meta.unreadCount}),this.$router.push({name:"inbox_view_conversation",params:{inboxId:n,notification_id:e}}))},closeContextMenu(){this.isContextMenuOpen=!1,this.contextMenuPosition={x:null,y:null},this.$emit("contextMenuClose")},openContextMenu(t){this.closeContextMenu(),t.preventDefault(),this.contextMenuPosition={x:t.pageX||t.clientX,y:t.pageY||t.clientY},this.isContextMenuOpen=!0,this.$emit("contextMenuOpen")},handleAction(t){switch(t){case"mark_as_read":this.$emit("markNotificationAsRead",this.notificationItem);break;case"mark_as_unread":this.$emit("markNotificationAsUnRead",this.notificationItem);break;case"delete":this.$emit("deleteNotification",this.notificationItem);break}}}},Ot={class:"relative flex items-center justify-between w-full"},wt={key:0,class:"absolute ltr:-left-3.5 rtl:-right-3.5 flex w-2 h-2 rounded bg-woot-500 dark:bg-woot-500"},Ct={class:"flex gap-2"},vt={class:"flex flex-row items-center justify-between w-full gap-2"},Nt={class:"text-xs font-medium text-slate-600 dark:text-slate-300 whitespace-nowrap"},gt={key:0,class:"flex items-center"},St={class:"text-xs font-medium text-woot-500 dark:text-woot-500"};function Tt(t,e,r,u,n,i){const h=d("InboxNameAndId"),l=d("PriorityIcon"),x=d("StatusIcon"),b=d("Thumbnail"),k=d("InboxContextMenu");return o(),a("div",{role:"button",class:g(["flex flex-col ltr:pl-5 rtl:pl-3 rtl:pr-5 ltr:pr-3 gap-2.5 py-3 w-full border-b border-slate-50 dark:border-slate-800/50 hover:bg-slate-25 dark:hover:bg-slate-800 cursor-pointer",r.active?"bg-slate-25 dark:bg-slate-800 click-animation":"bg-white dark:bg-slate-900"]),onContextmenu:e[0]||(e[0]=I=>i.openContextMenu(I)),onClick:e[1]||(e[1]=I=>i.openConversation(r.notificationItem))},[s("div",Ot,[i.isUnread?(o(),a("div",wt)):c("",!0),p(h,{inbox:i.inbox,"conversation-id":i.primaryActor.id},null,8,["inbox","conversation-id"]),s("div",Ct,[p(l,{priority:i.primaryActor.priority},null,8,["priority"]),p(x,{status:i.primaryActor.status},null,8,["status"])])]),s("div",vt,[i.assigneeMeta?(o(),f(b,{key:0,src:i.assigneeMeta.thumbnail,username:i.assigneeMeta.name,size:"16px"},null,8,["src","username"])):c("",!0),s("span",{class:g(["flex-1 overflow-hidden text-sm text-slate-800 dark:text-slate-50 text-ellipsis whitespace-nowrap",i.isUnread?"font-medium":"font-normal"])},m(i.pushTitle),3),s("span",Nt,m(i.lastActivityAt),1)]),i.snoozedUntilTime?(o(),a("div",gt,[s("span",St,m(i.snoozedDisplayText),1)])):c("",!0),n.isContextMenuOpen?(o(),f(k,{key:1,"context-menu-position":n.contextMenuPosition,"menu-items":i.menuItems,onClose:i.closeContextMenu,onSelectAction:i.handleAction},null,8,["context-menu-position","menu-items","onClose","onSelectAction"])):c("",!0)],34)}const Mt=y(kt,[["render",Tt],["__scopeId","data-v-71374c12"]]),At={components:{MenuItem:A},emits:["optionClick"],data(){return{menuItems:[{key:"mark_all_read",label:this.$t("INBOX.MENU_ITEM.MARK_ALL_READ")},{key:"delete_all",label:this.$t("INBOX.MENU_ITEM.DELETE_ALL")},{key:"delete_all_read",label:this.$t("INBOX.MENU_ITEM.DELETE_ALL_READ")}]}},methods:{onClick(t){this.$emit("optionClick",t)}}},Et={class:"z-50 flex flex-col w-40 gap-1 py-1 bg-white border divide-y shadow-md dark:bg-slate-900 border-slate-100 dark:border-slate-700/50 rounded-xl divide-slate-100 dark:divide-slate-700/50"},Dt={class:"flex flex-col"};function Rt(t,e,r,u,n,i){const h=d("MenuItem");return o(),a("div",Et,[s("div",Dt,[(o(!0),a(v,null,N(n.menuItems,l=>(o(),f(h,{key:l.key,label:l.label,onClick:S(x=>i.onClick(l.key),["stop"])},null,8,["label","onClick"]))),128))])])}const Bt=y(At,[["render",Rt]]),$t={emits:["filter"],setup(){const{uiSettings:t,updateUISettings:e}=M();return{uiSettings:t,updateUISettings:e}},data(){return{showSortMenu:!1,displayOptions:[{name:this.$t("INBOX.DISPLAY_MENU.DISPLAY_OPTIONS.SNOOZED"),key:_.INBOX_DISPLAY_BY.SNOOZED,selected:!1,type:_.INBOX_FILTER_TYPE.STATUS},{name:this.$t("INBOX.DISPLAY_MENU.DISPLAY_OPTIONS.READ"),key:_.INBOX_DISPLAY_BY.READ,selected:!1,type:_.INBOX_FILTER_TYPE.TYPE}],sortOptions:[{name:this.$t("INBOX.DISPLAY_MENU.SORT_OPTIONS.NEWEST"),key:_.INBOX_SORT_BY.NEWEST,type:_.INBOX_FILTER_TYPE.SORT_ORDER},{name:this.$t("INBOX.DISPLAY_MENU.SORT_OPTIONS.OLDEST"),key:_.INBOX_SORT_BY.OLDEST,type:_.INBOX_FILTER_TYPE.SORT_ORDER}],activeSort:_.INBOX_SORT_BY.NEWEST,activeDisplayFilter:{status:"",type:""}}},computed:{activeSortOption(){var t;return((t=this.sortOptions.find(e=>e.key===this.activeSort))==null?void 0:t.name)||""}},mounted(){this.setSavedFilter()},methods:{updateDisplayOption(t){this.displayOptions.forEach(e=>{e.key===t.key&&(e.selected=!t.selected,this.activeDisplayFilter[e.type]=e.selected?e.key:"",this.saveSelectedDisplayFilter(),this.$emit("filter",t))})},openSortMenu(){this.showSortMenu=!this.showSortMenu},onSortOptionClick(t){this.activeSort=t.key,this.showSortMenu=!1,this.saveSelectedDisplayFilter(),this.$emit("filter",t)},saveSelectedDisplayFilter(){this.updateUISettings({inbox_filter_by:{...this.activeDisplayFilter,sort_by:this.activeSort||_.INBOX_SORT_BY.NEWEST}})},setSavedFilter(){const{inbox_filter_by:t={}}=this.uiSettings,{status:e,type:r,sort_by:u}=t;this.activeSort=u||_.INBOX_SORT_BY.NEWEST,this.displayOptions.forEach(n=>{n.selected=n.type===_.INBOX_FILTER_TYPE.STATUS?n.key===e:n.key===r,this.activeDisplayFilter[n.type]=n.selected?n.key:""})}}},Lt={class:"flex flex-col bg-white z-50 dark:bg-slate-900 w-[170px] border shadow-md border-slate-100 dark:border-slate-700/50 rounded-xl divide-y divide-slate-100 dark:divide-slate-700/50"},Ft={class:"flex items-center justify-between p-3 rounded-t-lg h-11"},Ut={class:"flex gap-1.5"},Pt={class:"text-xs font-medium text-slate-800 dark:text-slate-100"},Xt={class:"relative"},Yt={class:"text-xs font-medium text-slate-600 dark:text-slate-300"},zt={key:0,class:"absolute flex flex-col gap-0.5 bg-white z-60 dark:bg-slate-800 rounded-md p-0.5 top-0 w-[70px] border border-slate-100 dark:border-slate-700/50"},Vt=["onClick"],Zt={class:"px-3 py-4 text-xs font-medium text-slate-400 dark:text-slate-400"},jt={class:"flex flex-col divide-y divide-slate-100 dark:divide-slate-700/50"},Ht=["id","name","checked","onChange"],Kt=["for"];function Wt(t,e,r,u,n,i){const h=d("fluent-icon");return o(),a("div",Lt,[s("div",Ft,[s("div",Ut,[p(h,{icon:"arrow-sort",type:"outline",size:"16",class:"text-slate-700 dark:text-slate-100"}),s("span",Pt,m(t.$t("INBOX.DISPLAY_MENU.SORT")),1)]),s("div",Xt,[s("div",{role:"button",class:"border h-5 flex gap-1 rounded-md items-center pr-1.5 pl-1 py-0.5 w-[70px] justify-between border-slate-100 dark:border-slate-700/50",onClick:e[0]||(e[0]=(...l)=>i.openSortMenu&&i.openSortMenu(...l))},[s("span",Yt,m(i.activeSortOption),1),p(h,{icon:"chevron-down",size:"12",class:"text-slate-600 dark:text-slate-200"})]),n.showSortMenu?(o(),a("div",zt,[(o(!0),a(v,null,N(n.sortOptions,l=>(o(),a("div",{key:l.key,role:"button",class:g(["flex rounded-[4px] h-5 w-full items-center justify-between p-0.5 gap-1",{"bg-woot-50 dark:bg-woot-700/50":n.activeSort===l.key}]),onClick:S(x=>i.onSortOptionClick(l),["stop"])},[s("span",{class:g(["text-xs font-medium hover:text-woot-600 dark:hover:text-woot-600",{"text-woot-600 dark:text-woot-600":n.activeSort===l.key,"text-slate-600 dark:text-slate-300":n.activeSort!==l.key}])},m(l.name),3),n.activeSort===l.key?(o(),f(h,{key:0,icon:"checkmark",size:"14",class:"text-woot-600 dark:text-woot-600"})):c("",!0)],10,Vt))),128))])):c("",!0)])]),s("div",null,[s("span",Zt,m(t.$t("INBOX.DISPLAY_MENU.DISPLAY")),1),s("div",jt,[(o(!0),a(v,null,N(n.displayOptions,l=>(o(),a("div",{key:l.key,class:"flex items-center px-3 py-2 gap-1.5 h-9"},[s("input",{id:l.key,type:"checkbox",name:l.key,checked:l.selected,class:"m-0 border-[1.5px] shadow border-slate-200 dark:border-slate-600 appearance-none rounded-[4px] w-4 h-4 dark:bg-slate-800 focus:ring-1 focus:ring-slate-100 dark:focus:ring-slate-700 checked:bg-woot-600 dark:checked:bg-woot-600 after:content-[''] after:text-white checked:after:content-['✓'] after:flex after:items-center after:justify-center checked:border-t checked:border-woot-700 dark:checked:border-woot-300 checked:border-b-0 checked:border-r-0 checked:border-l-0 after:text-center after:text-xs after:font-bold after:relative after:-top-[1.5px]",onChange:x=>i.updateDisplayOption(l)},null,40,Ht),s("label",{for:l.key,class:"text-xs font-medium text-slate-800 !ml-0 !mr-0 dark:text-slate-100"},m(l.name),9,Kt)]))),128))])])])}const Gt=y($t,[["render",Wt]]),qt={components:{InboxOptionMenu:Bt,InboxDisplayMenu:Gt},props:{isContextMenuOpen:{type:Boolean,default:!1}},emits:["redirect","filter"],data(){return{showInboxDisplayMenu:!1,showInboxOptionMenu:!1}},watch:{isContextMenuOpen:{handler(t){t&&(this.showInboxDisplayMenu=!1,this.showInboxOptionMenu=!1)},immediate:!0}},methods:{markAllRead(){w(C.MARK_ALL_NOTIFICATIONS_AS_READ),this.$store.dispatch("notifications/readAll").then(()=>{O(this.$t("INBOX.ALERTS.MARK_ALL_READ"))})},deleteAll(){this.$store.dispatch("notifications/deleteAll").then(()=>{O(this.$t("INBOX.ALERTS.DELETE_ALL"))})},deleteAllRead(){this.$store.dispatch("notifications/deleteAllRead").then(()=>{O(this.$t("INBOX.ALERTS.DELETE_ALL_READ"))})},openInboxDisplayMenu(){this.showInboxDisplayMenu=!this.showInboxDisplayMenu},openInboxOptionsMenu(){this.showInboxOptionMenu=!this.showInboxOptionMenu},onInboxOptionMenuClick(t){const r={mark_all_read:()=>this.markAllRead(),delete_all:()=>this.deleteAll(),delete_all_read:()=>this.deleteAllRead()}[t];r&&r(),this.$emit("redirect")},onFilterChange(t){this.$emit("filter",t),this.showInboxDisplayMenu=!1,this.$emit("redirect")}}},Jt={class:"flex items-center justify-between w-full py-2 border-b ltr:pl-4 rtl:pl-2 rtl:pr-4 ltr:pr-2 h-14 border-slate-50 dark:border-slate-800/50"},Qt={class:"flex items-center gap-1.5"},te={class:"text-xl font-medium text-slate-900 dark:text-slate-25"},ee={class:"relative"},ie={class:"text-xs font-medium text-center text-slate-600 dark:text-slate-200"},se={class:"relative flex items-center gap-1"};function ne(t,e,r,u,n,i){const h=d("fluent-icon"),l=d("InboxDisplayMenu"),x=d("woot-button"),b=d("InboxOptionMenu"),k=F("on-clickaway");return o(),a("div",Jt,[s("div",Qt,[s("h1",te,m(t.$t("INBOX.LIST.TITLE")),1),s("div",ee,[s("div",{role:"button",class:"flex items-center gap-1 px-2 py-1 border rounded-md border-slate-100 dark:border-slate-700/50",onClick:e[0]||(e[0]=(...I)=>i.openInboxDisplayMenu&&i.openInboxDisplayMenu(...I))},[s("span",ie,m(t.$t("INBOX.LIST.DISPLAY_DROPDOWN")),1),p(h,{icon:"chevron-down",size:"12",class:"text-slate-600 dark:text-slate-200"})]),n.showInboxDisplayMenu?T((o(),f(l,{key:0,class:"absolute top-9 ltr:left-0 rtl:right-0",onFilter:i.onFilterChange},null,8,["onFilter"])),[[k,i.openInboxDisplayMenu]]):c("",!0)])]),s("div",se,[p(x,{variant:"clear",size:"small","color-scheme":"secondary",icon:"mail-inbox",onClick:i.openInboxOptionsMenu},null,8,["onClick"]),n.showInboxOptionMenu?T((o(),f(b,{key:0,class:"absolute top-9 ltr:right-0 ltr:md:right-[unset] rtl:left-0 rtl:md:left-[unset]",onOptionClick:i.onInboxOptionMenuClick},null,8,["onOptionClick"])),[[k,i.openInboxOptionsMenu]]):c("",!0)])])}const oe=y(qt,[["render",ne]]),re={components:{InboxCard:Mt,InboxListHeader:oe,IntersectionObserver:V,CmdBarConversationSnooze:Z},setup(){const{uiSettings:t}=M();return{uiSettings:t}},data(){return{infiniteLoaderOptions:{root:this.$refs.notificationList,rootMargin:"100px 0px 100px 0px"},page:1,status:"",type:"",sortOrder:_.INBOX_SORT_BY.NEWEST,isInboxContextMenuOpen:!1,notificationIdToSnooze:null}},computed:{...B({meta:"notifications/getMeta",uiFlags:"notifications/getUIFlags",notification:"notifications/getFilteredNotifications"}),currentNotificationId(){return Number(this.$route.params.notification_id)},inboxFilters(){return{page:this.page,status:this.status,type:this.type,sortOrder:this.sortOrder}},notifications(){return this.notification(this.inboxFilters)},showEndOfList(){return this.uiFlags.isAllNotificationsLoaded&&!this.uiFlags.isFetching},showEmptyState(){return!this.uiFlags.isFetching&&!this.notifications.length}},watch:{inboxFilters(t,e){t!==e&&this.$store.dispatch("notifications/updateNotificationFilters",t)}},mounted(){this.setSavedFilter(),this.fetchNotifications()},methods:{fetchNotifications(){this.page=1,this.$store.dispatch("notifications/clear");const t=this.inboxFilters;this.$store.dispatch("notifications/index",t)},redirectToInbox(){this.$route.name!=="inbox_view"&&this.$router.replace({name:"inbox_view"})},loadMoreNotifications(){this.uiFlags.isAllNotificationsLoaded||(this.$store.dispatch("notifications/index",{page:this.page+1,status:this.status,type:this.type,sortOrder:this.sortOrder}),this.page+=1)},markNotificationAsRead(t){w(C.MARK_NOTIFICATION_AS_READ);const{id:e,primary_actor_id:r,primary_actor_type:u}=t;this.$store.dispatch("notifications/read",{id:e,primaryActorId:r,primaryActorType:u,unreadCount:this.meta.unreadCount}).then(()=>{O(this.$t("INBOX.ALERTS.MARK_AS_READ"))})},markNotificationAsUnRead(t){w(C.MARK_NOTIFICATION_AS_UNREAD),this.redirectToInbox();const{id:e}=t;this.$store.dispatch("notifications/unread",{id:e}).then(()=>{O(this.$t("INBOX.ALERTS.MARK_AS_UNREAD"))})},deleteNotification(t){w(C.DELETE_NOTIFICATION),this.redirectToInbox(),this.$store.dispatch("notifications/delete",{notification:t,unread_count:this.meta.unreadCount,count:this.meta.count}).then(()=>{O(this.$t("INBOX.ALERTS.DELETE"))})},onFilterChange(t){const{STATUS:e,TYPE:r,SORT_ORDER:u}=_.INBOX_FILTER_TYPE;t.type===e&&(this.status=t.selected?t.key:""),t.type===r&&(this.type=t.selected?t.key:""),t.type===u&&(this.sortOrder=t.key),this.fetchNotifications()},setSavedFilter(){const{inbox_filter_by:t={}}=this.uiSettings,{status:e,type:r,sort_by:u}=t;this.status=e,this.type=r,this.sortOrder=u||_.INBOX_SORT_BY.NEWEST,this.$store.dispatch("notifications/setNotificationFilters",this.inboxFilters)}}},ae={class:"flex w-full h-full bg-white dark:bg-slate-900"},le={ref:"notificationList",class:"flex flex-col w-full h-[calc(100%-56px)] overflow-x-hidden overflow-y-auto"},ce={key:0,class:"text-center"},de={key:1,class:"p-4 text-sm font-medium text-center text-slate-400 dark:text-slate-400"};function ue(t,e,r,u,n,i){const h=d("InboxListHeader"),l=d("InboxCard"),x=d("IntersectionObserver"),b=d("router-view"),k=d("CmdBarConversationSnooze");return o(),a("section",ae,[s("div",{class:g(["flex flex-col h-full w-full md:min-w-[360px] md:max-w-[360px] ltr:border-r border-slate-50 dark:border-slate-800/50",i.currentNotificationId?"hidden md:flex":"flex"])},[p(h,{"is-context-menu-open":n.isInboxContextMenuOpen,onFilter:i.onFilterChange,onRedirect:i.redirectToInbox},null,8,["is-context-menu-open","onFilter","onRedirect"]),s("div",le,[(o(!0),a(v,null,N(i.notifications,I=>(o(),f(l,{key:I.id,active:i.currentNotificationId===I.id,"notification-item":I,onMarkNotificationAsRead:i.markNotificationAsRead,onMarkNotificationAsUnRead:i.markNotificationAsUnRead,onDeleteNotification:i.deleteNotification,onContextMenuOpen:e[0]||(e[0]=E=>n.isInboxContextMenuOpen=!0),onContextMenuClose:e[1]||(e[1]=E=>n.isInboxContextMenuOpen=!1)},null,8,["active","notification-item","onMarkNotificationAsRead","onMarkNotificationAsUnRead","onDeleteNotification"]))),128)),t.uiFlags.isFetching?(o(),a("div",ce,e[2]||(e[2]=[s("span",{class:"mt-4 mb-4 spinner"},null,-1)]))):c("",!0),i.showEmptyState?(o(),a("p",de,m(t.$t("INBOX.LIST.NO_NOTIFICATIONS")),1)):c("",!0),!i.showEndOfList&&!t.uiFlags.isFetching?(o(),f(x,{key:2,options:n.infiniteLoaderOptions,onObserved:i.loadMoreNotifications},null,8,["options","onObserved"])):c("",!0)],512)],2),p(b),p(k)])}const Ze=y(re,[["render",ue]]);export{Ze as default};
