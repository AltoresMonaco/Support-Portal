import{m as g}from"./globalConfig-DaGjiImb.js";import{u as R,a as f}from"./index-BaHWIRRA.js";import{u as w,a9 as O,E as b}from"./dashboard-CGLIihvy.js";import{T as x}from"./Thumbnail-DLjRBBx8.js";import{L as v,A as M}from"./AddLocale-XHnnsO-D.js";import{_ as N,u as i,H as D,o as d,n as L,p as t,e as r,t as o,l as h,m as A,g as I,B as G,F as k,i as H,a as C,k as y}from"./_plugin-vue_export-helper-CvYNw_mv.js";import{S as F}from"./Spinner-B-aSVz3z.js";import{a as $}from"./portalHelper-trLcR8pg.js";import"./index-Y4OjWrJ-.js";import"./_commonjsHelpers-BosuxZz1.js";import"./axios-CCb-kr4I.js";import"./mutationHelpers-3VTcoJiD.js";import"./vue-router-CNCrM2WK.js";import"./index-BP-sUqpX.js";import"./index-DaWXXnfb.js";import"./globalConfigMixin-BNbqaRx5.js";import"./timeHelper-BT38nsET.js";import"./index-BO4rcqbh.js";import"./utils.esm-CA3tRshB.js";import"./exports-CsC-x4VI.js";import"./index-C2DForDf.js";import"./useKeyboardNavigableList-Cfstgo2Q.js";import"./helper-DcGaBm2u.js";import"./DashboardIcon-CPXNa31t.js";import"./AudioNotificationHelper-CDrFIep2.js";import"./Icon-Dtj3LCzD.js";import"./Validators-eX6_8wdj.js";import"./vue-dompurify-html-DZ5r8uTJ.js";import"./module-CGzIBJZi.js";const U={components:{Thumbnail:x,LocaleItemTable:v},props:{portal:{type:Object,default:()=>{}},status:{type:String,default:"",values:["archived","draft","published"]}},emits:["addLocale","openSite"],setup(){const{updateUISettings:e}=w();return{updateUISettings:e}},data(){return{showDeleteConfirmationPopup:!1,alertMessage:"",selectedPortalForDelete:{}}},computed:{labelColor(){switch(this.status){case"Archived":return"warning";default:return"success"}},deleteMessageValue(){return` ${this.selectedPortalForDelete.name}?`},locales(){return this.portal?this.portal.config.allowed_locales:[]},allowedLocales(){return Object.keys(this.locales).map(e=>this.locales[e].code)},articleCount(){const{allowed_locales:e}=this.portal.config;return e.reduce((l,s)=>l+s.articles_count,0)}},methods:{addLocale(){this.$emit("addLocale",this.portal.id)},openSite(){this.$emit("openSite",this.portal.slug)},openSettings(){this.fetchPortalAndItsCategories(),this.navigateToPortalEdit()},onClickOpenDeleteModal(e){this.selectedPortalForDelete=e,this.showDeleteConfirmationPopup=!0},closeDeletePopup(){this.showDeleteConfirmationPopup=!1},async fetchPortalAndItsCategories(){await this.$store.dispatch("portals/index");const{slug:e,config:{allowed_locales:l}}=this.portal,s={portalSlug:e,locale:l[0].code};this.$store.dispatch("portals/show",s),this.$store.dispatch("categories/index",s)},async onClickDeletePortal(){const{slug:e}=this.selectedPortalForDelete;try{await this.$store.dispatch("portals/delete",{portalSlug:e}),this.selectedPortalForDelete={},this.closeDeletePopup(),this.alertMessage=this.$t("HELP_CENTER.PORTAL.PORTAL_SETTINGS.DELETE_PORTAL.API.DELETE_SUCCESS"),this.updateUISettings({last_active_portal_slug:void 0,last_active_locale_code:void 0})}catch(l){this.alertMessage=(l==null?void 0:l.message)||this.$t("HELP_CENTER.PORTAL.PORTAL_SETTINGS.DELETE_PORTAL.API.DELETE_ERROR")}finally{R(this.alertMessage)}},changeDefaultLocale({localeCode:e}){this.updatePortalLocales({allowedLocales:this.allowedLocales,defaultLocale:e,successMessage:this.$t("HELP_CENTER.PORTAL.CHANGE_DEFAULT_LOCALE.API.SUCCESS_MESSAGE"),errorMessage:this.$t("HELP_CENTER.PORTAL.CHANGE_DEFAULT_LOCALE.API.ERROR_MESSAGE")}),f(O.SET_DEFAULT_LOCALE,{newLocale:e,from:this.$route.name})},deletePortalLocale({localeCode:e}){const l=this.allowedLocales.filter(E=>E!==e),s=this.portal.meta.default_locale;this.updatePortalLocales({allowedLocales:l,defaultLocale:s,successMessage:this.$t("HELP_CENTER.PORTAL.DELETE_LOCALE.API.SUCCESS_MESSAGE"),errorMessage:this.$t("HELP_CENTER.PORTAL.DELETE_LOCALE.API.ERROR_MESSAGE")}),f(O.DELETE_LOCALE,{deletedLocale:e,from:this.$route.name})},async updatePortalLocales({allowedLocales:e,defaultLocale:l,successMessage:s,errorMessage:E}){try{await this.$store.dispatch("portals/update",{portalSlug:this.portal.slug,config:{default_locale:l,allowed_locales:e}}),this.alertMessage=s}catch(n){this.alertMessage=(n==null?void 0:n.message)||E}finally{R(this.alertMessage)}},navigateToPortalEdit(){this.$router.push({name:"edit_portal_information",params:{portalSlug:this.portal.slug}})}}},B={class:"relative flex p-4 mb-3 bg-white border border-solid rounded-md dark:bg-slate-900 border-slate-100 dark:border-slate-600"},V={class:"flex-grow ml-2 rtl:ml-0 rtl:mr-2"},j={class:"flex items-start justify-between mb-8"},z={class:"flex items-center"},q={class:"mb-0 text-lg text-slate-800 dark:text-slate-100"},W={class:"mb-0 text-sm text-slate-700 dark:text-slate-200"},X={class:"flex flex-row gap-1"},Y={class:"mb-12"},J={class:"mb-2 text-base font-medium text-slate-800 dark:text-slate-100"},K={class:"flex justify-between mr-[6.25rem] rtl:mr-0 rtl:ml-[6.25rem] max-w-[80vw]"},Q={class:"flex flex-col"},Z={class:"flex flex-col items-start mb-4"},ee={class:"text-sm text-slate-600 dark:text-slate-300"},te={class:"flex flex-col items-start mb-4"},le={class:"text-sm text-slate-600 dark:text-slate-300"},se={class:"flex flex-col"},oe={class:"flex flex-col items-start mb-4"},ae={class:"text-sm text-slate-600 dark:text-slate-300"},re={class:"flex flex-col items-start mb-4"},ie={class:"text-sm text-slate-600 dark:text-slate-300"},ne={class:"flex flex-col"},ce={class:"flex flex-col items-start mb-4"},de={class:"flex items-center"},Ee={class:"flex flex-col items-start mb-4"},_e={class:"text-sm text-slate-600 dark:text-slate-300"},Te={class:"mb-12"},me={class:"mb-2 text-base font-medium text-slate-800 dark:text-slate-100"};function Le(e,l,s,E,n,a){const u=i("Thumbnail"),p=i("woot-label"),c=i("woot-button"),P=i("LocaleItemTable"),S=i("woot-delete-modal"),_=D("tooltip");return d(),L("div",null,[t("div",B,[r(u,{username:s.portal.name,variant:"square"},null,8,["username"]),t("div",V,[t("header",j,[t("div",null,[t("div",z,[t("h2",q,o(s.portal.name),1),r(p,{title:s.status,"color-scheme":a.labelColor,size:"small",variant:"smooth",class:"mx-2 my-0"},null,8,["title","color-scheme"])]),t("p",W,o(a.articleCount)+" "+o(e.$t("HELP_CENTER.PORTAL.PORTAL_SETTINGS.LIST_ITEM.HEADER.COUNT_LABEL")),1)]),t("div",X,[r(c,{variant:"smooth",size:"small","color-scheme":"primary",onClick:a.addLocale},{default:h(()=>[A(o(e.$t("HELP_CENTER.PORTAL.PORTAL_SETTINGS.LIST_ITEM.HEADER.ADD")),1)]),_:1},8,["onClick"]),r(c,{variant:"hollow",size:"small","color-scheme":"secondary",onClick:a.openSite},{default:h(()=>[A(o(e.$t("HELP_CENTER.PORTAL.PORTAL_SETTINGS.LIST_ITEM.HEADER.VISIT")),1)]),_:1},8,["onClick"]),I(r(c,{variant:"hollow",size:"small",icon:"settings","color-scheme":"secondary",onClick:a.openSettings},null,8,["onClick"]),[[_,e.$t("HELP_CENTER.PORTAL.PORTAL_SETTINGS.LIST_ITEM.HEADER.SETTINGS"),void 0,{"top-end":!0}]]),I(r(c,{variant:"hollow","color-scheme":"alert",size:"small",icon:"delete",onClick:l[0]||(l[0]=T=>a.onClickOpenDeleteModal(s.portal))},null,512),[[_,e.$t("HELP_CENTER.PORTAL.PORTAL_SETTINGS.LIST_ITEM.HEADER.DELETE"),void 0,{"top-end":!0}]])])]),t("div",Y,[t("h2",J,o(e.$t("HELP_CENTER.PORTAL.PORTAL_SETTINGS.LIST_ITEM.PORTAL_CONFIG.TITLE")),1),t("div",K,[t("div",Q,[t("div",Z,[t("label",null,o(e.$t("HELP_CENTER.PORTAL.PORTAL_SETTINGS.LIST_ITEM.PORTAL_CONFIG.ITEMS.NAME")),1),t("span",ee,o(s.portal.name),1)]),t("div",te,[t("label",null,o(e.$t("HELP_CENTER.PORTAL.PORTAL_SETTINGS.LIST_ITEM.PORTAL_CONFIG.ITEMS.DOMAIN")),1),t("span",le,o(s.portal.custom_domain),1)])]),t("div",se,[t("div",oe,[t("label",null,o(e.$t("HELP_CENTER.PORTAL.PORTAL_SETTINGS.LIST_ITEM.PORTAL_CONFIG.ITEMS.SLUG")),1),t("span",ae,o(s.portal.slug),1)]),t("div",re,[t("label",null,o(e.$t("HELP_CENTER.PORTAL.PORTAL_SETTINGS.LIST_ITEM.PORTAL_CONFIG.ITEMS.TITLE")),1),t("span",ie,o(s.portal.page_title),1)])]),t("div",ne,[t("div",ce,[t("label",null,o(e.$t("HELP_CENTER.PORTAL.PORTAL_SETTINGS.LIST_ITEM.PORTAL_CONFIG.ITEMS.THEME")),1),t("div",de,[t("div",{class:"w-4 h-4 mr-1 border border-solid rounded-md rtl:mr-0 rtl:ml-1 border-slate-25 dark:border-slate-800",style:G({background:s.portal.color})},null,4)])]),t("div",Ee,[t("label",null,o(e.$t("HELP_CENTER.PORTAL.PORTAL_SETTINGS.LIST_ITEM.PORTAL_CONFIG.ITEMS.SUB_TEXT")),1),t("span",_e,o(s.portal.header_text),1)])])])]),t("div",Te,[t("h2",me,o(e.$t("HELP_CENTER.PORTAL.PORTAL_SETTINGS.LIST_ITEM.AVAILABLE_LOCALES.TITLE")),1),r(P,{locales:a.locales,"selected-locale-code":s.portal.meta.default_locale,onChangeDefaultLocale:a.changeDefaultLocale,onDelete:a.deletePortalLocale},null,8,["locales","selected-locale-code","onChangeDefaultLocale","onDelete"])])])]),r(S,{show:n.showDeleteConfirmationPopup,"onUpdate:show":l[1]||(l[1]=T=>n.showDeleteConfirmationPopup=T),"on-close":a.closeDeletePopup,"on-confirm":a.onClickDeletePortal,title:e.$t("HELP_CENTER.PORTAL.PORTAL_SETTINGS.DELETE_PORTAL.TITLE"),message:e.$t("HELP_CENTER.PORTAL.PORTAL_SETTINGS.DELETE_PORTAL.MESSAGE"),"message-value":a.deleteMessageValue,"confirm-text":e.$t("HELP_CENTER.PORTAL.PORTAL_SETTINGS.DELETE_PORTAL.YES"),"reject-text":e.$t("HELP_CENTER.PORTAL.PORTAL_SETTINGS.DELETE_PORTAL.NO")},null,8,["show","on-close","on-confirm","title","message","message-value","confirm-text","reject-text"])])}const he=N(U,[["render",Le]]),ue={components:{PortalListItem:he,EmptyState:b,Spinner:F,AddLocale:M},data(){return{isAddLocaleModalOpen:!1,selectedPortal:{}}},computed:{...g({portals:"portals/allPortals",isFetching:"portals/isFetchingPortals"}),portalStatus(){return this.archived?"Archived":"Live"},shouldShowEmptyState(){return!this.isFetching&&!this.portals.length}},methods:{openPortal(e){window.open($(e),"_blank")},addPortal(){this.$router.push({name:"new_portal_information"})},closeAddLocaleModal(){this.isAddLocaleModalOpen=!1,this.selectedPortal={}},addLocale(e){this.isAddLocaleModalOpen=!0,this.selectedPortal=this.portals.find(l=>l.id===e)}}},pe={class:"w-full max-w-full px-4 py-2"},Pe={class:"flex items-center justify-between h-12 mx-0 mt-0 mb-2"},Se={class:"flex items-center"},Ae={class:"mx-2 my-0 text-2xl font-medium text-slate-800 dark:text-slate-100"},Re={class:"h-[90vh] overflow-y-scroll"},fe={key:0,class:"flex items-center justify-center p-40 text-base"};function Oe(e,l,s,E,n,a){const u=i("woot-sidemenu-icon"),p=i("woot-button"),c=i("PortalListItem"),P=i("Spinner"),S=i("EmptyState"),_=i("AddLocale"),T=i("woot-modal");return d(),L("div",pe,[t("div",Pe,[t("div",Se,[r(u),t("h1",Ae,o(e.$t("HELP_CENTER.PORTAL.HEADER")),1)]),r(p,{"color-scheme":"primary",icon:"add",size:"small",onClick:a.addPortal},{default:h(()=>[A(o(e.$t("HELP_CENTER.PORTAL.NEW_BUTTON")),1)]),_:1},8,["onClick"])]),t("div",Re,[(d(!0),L(k,null,H(e.portals,m=>(d(),C(c,{key:m.id,portal:m,status:a.portalStatus,onAddLocale:a.addLocale,onOpenSite:a.openPortal},null,8,["portal","status","onAddLocale","onOpenSite"]))),128)),e.isFetching?(d(),L("div",fe,[r(P),t("span",null,o(e.$t("HELP_CENTER.PORTAL.LOADING_MESSAGE")),1)])):a.shouldShowEmptyState?(d(),C(S,{key:1,title:e.$t("HELP_CENTER.PORTAL.NO_PORTALS_MESSAGE")},null,8,["title"])):y("",!0)]),r(T,{show:n.isAddLocaleModalOpen,"onUpdate:show":l[0]||(l[0]=m=>n.isAddLocaleModalOpen=m),"on-close":a.closeAddLocaleModal},{default:h(()=>[r(_,{show:n.isAddLocaleModalOpen,portal:n.selectedPortal,onCancel:a.closeAddLocaleModal},null,8,["show","portal","onCancel"])]),_:1},8,["show","on-close"])])}const et=N(ue,[["render",Oe]]);export{et as default};
