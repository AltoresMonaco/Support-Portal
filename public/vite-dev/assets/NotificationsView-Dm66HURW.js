import{m as T}from"./globalConfig-DaGjiImb.js";import{a as g}from"./index-BaHWIRRA.js";import{_ as N}from"./TableFooter-DOGhqcuD.js";import{T as b}from"./Thumbnail-DLjRBBx8.js";import{S as E}from"./Spinner-B-aSVz3z.js";import{E as I,q as y}from"./dashboard-CGLIihvy.js";import{u as S}from"./timeHelper-BT38nsET.js";import{_ as k,u as r,o as a,n as s,a as h,k as c,p as o,g as v,v as w,F as O,i as F,q as $,t as l,e as f}from"./_plugin-vue_export-helper-CvYNw_mv.js";import"./index-Y4OjWrJ-.js";import"./_commonjsHelpers-BosuxZz1.js";import"./axios-CCb-kr4I.js";import"./mutationHelpers-3VTcoJiD.js";import"./vue-router-CNCrM2WK.js";import"./index-BP-sUqpX.js";import"./index-DaWXXnfb.js";import"./globalConfigMixin-BNbqaRx5.js";import"./index-C2DForDf.js";import"./useKeyboardNavigableList-Cfstgo2Q.js";import"./helper-DcGaBm2u.js";import"./utils.esm-CA3tRshB.js";import"./DashboardIcon-CPXNa31t.js";import"./AudioNotificationHelper-CDrFIep2.js";import"./exports-CsC-x4VI.js";import"./Icon-Dtj3LCzD.js";import"./Validators-eX6_8wdj.js";import"./vue-dompurify-html-DZ5r8uTJ.js";import"./module-CGzIBJZi.js";import"./index-BO4rcqbh.js";const L={components:{Thumbnail:b,Spinner:E,EmptyState:I},props:{notifications:{type:Array,default:()=>[]},isLoading:{type:Boolean,default:!1},isUpdating:{type:Boolean,default:!1},onClickNotification:{type:Function,default:()=>{}},onMarkAllDoneClick:{type:Function,default:()=>{}}},computed:{...T({notificationMetadata:"notifications/getMeta"}),showEmptyResult(){return!this.isLoading&&this.notifications.length===0}},methods:{dynamicTime:S}},P={class:"flex-grow flex-shrink h-full px-4 py-8 overflow-hidden bg-white dark:bg-slate-900"},M={class:"woot-table notifications-table"},D=["onClick"],G={class:"overflow-hidden flex-view notification-contant--wrap whitespace-nowrap text-ellipsis"},x={class:"notification--title"},B={class:"overflow-hidden notification--message-title whitespace-nowrap text-ellipsis"},V={class:"text-right"},R={class:"notification--type"},U={class:"thumbnail--column"},z={class:"text-right timestamp--column"},q={class:"notification--created-at"},K={key:0,class:"notification--unread-indicator"},Y={key:2,class:"notifications--loader"};function j(t,d,e,p,u,n){const m=r("woot-submit-button"),_=r("Thumbnail"),C=r("EmptyState"),A=r("Spinner");return a(),s("section",P,[t.notificationMetadata.unreadCount?(a(),h(m,{key:0,class:"button nice success button--fixed-top","button-text":t.$t("NOTIFICATIONS_PAGE.MARK_ALL_DONE"),loading:e.isUpdating,onClick:e.onMarkAllDoneClick},null,8,["button-text","loading","onClick"])):c("",!0),o("table",M,[v(o("tbody",null,[(a(!0),s(O,null,F(e.notifications,i=>(a(),s("tr",{key:i.id,class:$({"is-unread":i.read_at===null}),onClick:()=>e.onClickNotification(i)},[o("td",null,[o("div",G,[o("h5",x,l(`#${i.primary_actor?i.primary_actor.id:t.$t("NOTIFICATIONS_PAGE.DELETE_TITLE")}`),1),o("span",B,l(i.push_message_title),1)])]),o("td",V,[o("span",R,l(t.$t(`NOTIFICATIONS_PAGE.TYPE_LABEL.${i.notification_type}`)),1)]),o("td",U,[i.primary_actor.meta.assignee?(a(),h(_,{key:0,src:i.primary_actor.meta.assignee.thumbnail,size:"36px",username:i.primary_actor.meta.assignee.name},null,8,["src","username"])):c("",!0)]),o("td",null,[o("div",z,[o("span",q,l(n.dynamicTime(i.last_activity_at)),1)])]),o("td",null,[i.read_at?c("",!0):(a(),s("div",K))])],10,D))),128))],512),[[w,!e.isLoading]])]),n.showEmptyResult?(a(),h(C,{key:1,title:t.$t("NOTIFICATIONS_PAGE.LIST.404")},null,8,["title"])):c("",!0),e.isLoading?(a(),s("div",Y,[f(A),o("span",null,l(t.$t("NOTIFICATIONS_PAGE.LIST.LOADING_MESSAGE")),1)])):c("",!0)])}const H=k(L,[["render",j],["__scopeId","data-v-9e014f9f"]]),J={components:{NotificationTable:H,TableFooter:N},computed:{...T({accountId:"getCurrentAccountId",meta:"notifications/getMeta",records:"notifications/getNotifications",uiFlags:"notifications/getUIFlags"})},mounted(){this.$store.dispatch("notifications/get",{page:1})},methods:{onPageChange(t){window.history.pushState({},null,`${this.$route.path}?page=${t}`),this.$store.dispatch("notifications/get",{page:t})},openConversation(t){const{primary_actor_id:d,primary_actor_type:e,primary_actor:{id:p},notification_type:u}=t;g(y.OPEN_CONVERSATION_VIA_NOTIFICATION,{notificationType:u}),this.$store.dispatch("notifications/read",{id:t.id,primaryActorId:d,primaryActorType:e,unreadCount:this.meta.unreadCount}),this.$router.push(`/app/accounts/${this.accountId}/conversations/${p}`)},onMarkAllDoneClick(){g(y.MARK_AS_READ_NOTIFICATIONS),this.$store.dispatch("notifications/readAll")}}},Q={class:"h-full overflow-y-auto"},W={class:"flex flex-col h-full"};function X(t,d,e,p,u,n){const m=r("NotificationTable"),_=r("TableFooter");return a(),s("div",Q,[o("div",W,[f(m,{notifications:t.records,"is-loading":t.uiFlags.isFetching,"is-updating":t.uiFlags.isUpdating,"on-click-notification":n.openConversation,"on-mark-all-done-click":n.onMarkAllDoneClick},null,8,["notifications","is-loading","is-updating","on-click-notification","on-mark-all-done-click"]),f(_,{class:"border-t border-slate-75 dark:border-slate-700/50","current-page":Number(t.meta.currentPage),"total-count":t.meta.count,"page-size":15,onPageChange:n.onPageChange},null,8,["current-page","total-count","onPageChange"])])])}const St=k(J,[["render",X],["__scopeId","data-v-58580fb0"]]);export{St as default};
