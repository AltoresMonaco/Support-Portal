import{m as h}from"./globalConfig-DaGjiImb.js";import{at as A,Y as T}from"./dashboard-CGLIihvy.js";import{u as _}from"./index-BaHWIRRA.js";import{u as f}from"./index-C2DForDf.js";import{S}from"./Spinner-B-aSVz3z.js";import{A as E}from"./AgentSelector-CIdm-MKD.js";import{_ as b,o as a,n as m,p as i,e as w,t as I,k as N,a as d,f as $,u as o}from"./_plugin-vue_export-helper-CvYNw_mv.js";import"./axios-CCb-kr4I.js";import"./_commonjsHelpers-BosuxZz1.js";import"./mutationHelpers-3VTcoJiD.js";import"./vue-router-CNCrM2WK.js";import"./index-BP-sUqpX.js";import"./index-DaWXXnfb.js";import"./globalConfigMixin-BNbqaRx5.js";import"./timeHelper-BT38nsET.js";import"./Thumbnail-DLjRBBx8.js";import"./index-BO4rcqbh.js";import"./utils.esm-CA3tRshB.js";import"./exports-CsC-x4VI.js";import"./useKeyboardNavigableList-Cfstgo2Q.js";import"./helper-DcGaBm2u.js";import"./DashboardIcon-CPXNa31t.js";import"./AudioNotificationHelper-CDrFIep2.js";import"./index-Y4OjWrJ-.js";import"./Icon-Dtj3LCzD.js";import"./Validators-eX6_8wdj.js";import"./vue-dompurify-html-DZ5r8uTJ.js";import"./module-CGzIBJZi.js";const k={components:{Spinner:S,PageHeader:A,AgentSelector:E},validations:{selectedAgents:{isEmpty(){return!!this.selectedAgents.length}}},setup(){return{v$:f()}},data(){return{selectedAgents:[],isCreating:!1}},computed:{...h({agentList:"agents/getAgents",uiFlags:"teamMembers/getUIFlags"}),teamId(){return this.$route.params.teamId},headerTitle(){return this.$t("TEAMS_SETTINGS.EDIT_FLOW.AGENTS.TITLE",{teamName:this.currentTeam.name})},currentTeam(){return this.$store.getters["teams/getTeam"](this.teamId)},teamMembers(){return this.$store.getters["teamMembers/getTeamMembers"](this.teamId)},showAgentsList(){const{id:e}=this.currentTeam;return e&&!this.uiFlags.isFetching}},async mounted(){const{teamId:e}=this.$route.params;this.$store.dispatch("agents/get");try{await this.$store.dispatch("teamMembers/get",{teamId:e});const t=this.teamMembers.map(r=>r.id);this.updateSelectedAgents(t)}catch{this.updateSelectedAgents([])}},methods:{updateSelectedAgents(e){this.v$.selectedAgents.$touch(),this.selectedAgents=[...e]},async addAgents(){this.isCreating=!0;const{teamId:e,selectedAgents:t}=this;try{await this.$store.dispatch("teamMembers/update",{teamId:e,agentsList:t}),T.replace({name:"settings_teams_edit_finish",params:{page:"edit",teamId:e}}),this.$store.dispatch("teams/get")}catch(r){_(r.message)}this.isCreating=!1}}},v={class:"border border-slate-25 overflow-x-auto dark:border-slate-800/60 bg-white dark:bg-slate-900 h-full p-6 w-full max-w-full md:w-3/4 md:max-w-[75%] flex-shrink-0 flex-grow-0"},M={class:"w-full"},x={class:"w-full"},L={key:0},y={class:"error-message"};function G(e,t,r,l,n,s){const c=o("PageHeader"),g=o("AgentSelector"),p=o("Spinner");return a(),m("div",v,[i("form",{class:"flex flex-wrap mx-0 overflow-x-auto",onSubmit:t[0]||(t[0]=$((...u)=>s.addAgents&&s.addAgents(...u),["prevent"]))},[i("div",M,[w(c,{"header-title":s.headerTitle,"header-content":e.$t("TEAMS_SETTINGS.EDIT_FLOW.AGENTS.DESC")},null,8,["header-title","header-content"])]),i("div",x,[l.v$.selectedAgents.$error?(a(),m("div",L,[i("p",y,I(e.$t("TEAMS_SETTINGS.ADD.AGENT_VALIDATION_ERROR")),1)])):N("",!0),s.showAgentsList?(a(),d(g,{key:1,"agent-list":e.agentList,"selected-agents":n.selectedAgents,"update-selected-agents":s.updateSelectedAgents,"is-working":n.isCreating,"submit-button-text":e.$t("TEAMS_SETTINGS.EDIT_FLOW.AGENTS.BUTTON_TEXT")},null,8,["agent-list","selected-agents","update-selected-agents","is-working","submit-button-text"])):(a(),d(p,{key:2}))])],32)])}const me=b(k,[["render",G]]);export{me as default};
